{
  "name": "haraldops",
  "description": "Functions for operation, notification and provisioning by Harald Rudell",
  "author": {
    "name": "Harald Rudell",
    "email": "harald@allgoodapps.com"
  },
  "keywords": [
    "operations",
    "email",
    "notification"
  ],
  "version": "0.1.10",
  "contributors": [
    {
      "name": "Harald Rudell",
      "email": "harald@allgoodapps.com",
      "url": "http://blog.haraldrudell.com"
    }
  ],
  "devDependencies": {
    "mochawrapper": ">= 0.0.31"
  },
  "dependencies": {
    "greatjson": ">= 0.0.8",
    "haraldutil": ">= 0.1.5",
    "nodemailer": ">= 0.3",
    "request": ">= 0.0.1"
  },
  "repository": {
    "type": "git",
    "url": "https://haraldrudell@github.com/haraldrudell/haraldops.git"
  },
  "main": "./lib/haraldops",
  "scripts": {
    "test": "mocha --ui exports --reporter spec",
    "monitor": "mocha --ui exports --reporter min --watch",
    "debugtest": "mocha --debug-brk --ui exports --reporter spec",
    "coverage": "mochacoverage"
  },
  "readme": "# haraldops\nFacilitates configuration, operation and service notifications for node.js applications\n\n## Benefits\n\n1. Configure the apps in json from outside its source tree\n2. Single-line setup of operations details\n3. Email communications from your apps\n4. Monitor incoming requests with user agent string and origin\n5. Capture console output with log file output, rotate, and error stack traces\n6. Self-monitor by having multiple deployments monitor each other as well as external apps and Web locations\n7. Portably find function-specific folders and access the system browser\n8. Load app-specific json data from configurable out-of-source tree locations\n\n## Features\n\n1. Flexible loading of out-of-source tree json data\n2. Email service wrapping various implementations including gmail\n3. Configurable heartbeat pinger-responder\n4. Express request logging\n5. stdout to file management\n5. OS portability layer\n\n# Usage\n## Loading per-machine configuration\n```js\nvar defaults = require('haraldops').init({appName: 'Node.js #3'})\n```\n* Derives a filesystem friendly app identifier a-z0-9, in this case 'nodejs3'\n* Looks for a .json file by this name  in $HOME/apps, $HOME or the folder the executing app is deployed to.\n* Loads the json and configures accordingly\n\nThe following values are known to be present in the returned object:\n* defaults.init.appName: string Name of the application eg. 'Node.js #3'\n* defaults.init.identifier: string Identifier to use eg. 'nodejs3'\n* defaults.init.appFolder: string Path to the apps folder eg. '/home/user/folder'\n* defaults.init.tmpFolder: string Path to a suitable temporary folder eg. '/home/user/tmp' or '/tmp'\n* defaults.init.homeFolder string Path to user's home folder eg. '/home/user'\n* defaults.init.logger function configured logging function\n\nThese top-level properties affects init:\n* logger: function, optional: log to this function, default is console.log\n* appName: string, optional: app name used, default is the name of the folder where the executing app is\n* identifier: string, optional: identifier used when locating settings files, default is derived from appName\n* NoFile: boolean, optional: if present and true, no file is loaded\n\nOther properties are copied to the return value object\n\nProperties loaded from file override those provided in argument\n\n# Examples\n\n## Sending Mail\nusing argument object:\n```js\nvar defaults = require('haraldops').init({\n\tharaldops: {\n\t\tmailsend: {\n\t\t\tuser: 'sender@gmail.com',\n\t\t\tpass: 'password',\n\t\t\tto: 'recipient@gmail.com',\n\t\t},\n\t},\n\tnoFile: true,\n})\ndefaults.init.ops.sendMail('subject', 'body')\n```\n\nUsing a configuration file godo.json:\n```js\n{\n\t\"haraldops\": {\n\t\t\"mailsend\": {\n\t\t\t\"user\": \"sender@gmail.com\",\n\t\t\t\"pass\": \"password\",\n\t\t\t\"to\": \"recipient@gmail.com\"\n\t\t}\n\t}\n}\n```\n\n```js\nvar defaults = require('haraldops').init({appName: 'Go Do'})\ndefaults.init.ops.sendMail('subject', 'body')\n```\n\n## Sample Configuration File\n```js\n{\n\t\"PORT\": 3000,\n\t\"haraldops\": {\n\t\t\"mailsend\": {\n\t\t\t\"user\": \"sender@gmail.com\",\n\t\t\t\"pass\": \"password\",\n\t\t\t\"to\": \"recipient@gmail.com\"\n\t\t},\n\t\t\"responder\": \"/status\",\n\t\t\"identifier\": \"thisapp\",\n\t\t\"pingers\": [\n\t\t\t{\n\t\t\t\t\"title\": \"Make sure Google is up\",\n\t\t\t\t\"url\": \"http://www.google.com/\",\n\t\t\t\t\"isPingerList\": false\t\t\t\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"title\": \"Another deployment\",\n\t\t\t\t\"url\": \"http://www.example.com/status\",\n\t\t\t\t\"app\": \"monitoredappidentifier\"\n\t\t\t}\n\t\t]\n\t},\n\t\"fbAppSecret\": \"55555\",\n\t\"appInterface\": \"localhost\",\n\t\"sessionSecret\": \"verygreat\",\n\t\"ignoreUris\": [\n\t\t\"/status\",\n\t\t\"/favicon.ico\",\n\t\t\"regexp:/images.*\",\n\t\t\"regexp:/stylesheets.*\",\n\t\t\"regexp:/javascripts.*\"\n\t]\n}\n```\n\n## Monitoring of Google\nWill send email if Google does not respond for 5 minutes\n```js\nvar ops = require('haraldops').opsconstructor({\n\tharaldops: {\n\t\tmailsend: {\n\t\t\tuser: 'sender@gmail.com',\n\t\t\tpass: 'password',\n\t\t\tto: 'recipient@gmail.com',\n\t\t},\n\t\tpingers: [\n\t\t\t{\n\t\t\t\ttitle: \"Google\",\n\t\t\t\turl: \"http://google.com\",\n\t\t\t\tisPingerList: false\n\t\t\t}\n\t\t]\n\t},\n\tnoFile: true,\t\n})\n```\n\n# Configuration Reference\n\n* haraldops.errorstack: true: adds\n* haraldops.logFile: '/tmp/x': copies console output to the provided file\n* haraldops.logRotate: 'day': period of rotation minute hour day month year\n\n# Function Reference\n\n## logrequest(logger, ignoreTheseUris)\n```js\nvar haraldops = require('haraldops')\nvar ignoreUris = [\n\t'/status', '/favicon.ico', /\\/images.*/,\n\t/\\/stylesheets.*/, /\\/javascripts.*/,\n]\napp = express.createServer()\napp.configure(function(){\n\tapp.use(haraldops.logrequest(console.log, ignoreUris))\n...\n```\nLogs incoming requests. Handles load-balancer forwarding.\n\n* logger: a function that prints a single string argument\n* ignoreTheseUris a string, a regexp or an array of those types: do not log these requests\n\noutput: Time stamp, request method, host, client and user agent string\n```\n2012-05-16T23:11Z GET http://localhost:3000/ 127.0.0.1:53169 Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.46 Safari/536.5\n```\n\n## defaults.init.ops.sendMail(subject, body)\nSend mail using the object returned by opsconstructor or mailconstructor.\n\n## defaults.init.ops.closeMail()\nCloses mail when all pending messages has been sent. Function property of the object returned by opsconstructor or mailconstructor.\n\n## defaults.init.ops.responder(app, url)\n```js\nvar haraldops = require('haraldops')\nvar o = {\n\tuser: 'sender@gmail.com', pass: 'secret', to: 'me@gmail.com',\n\tresponder: '/status'\n}\nvar opsObject = haraldops.opsconstructor(console.log, o)\nvar app = express.createServer()\nopsObject.responder(app, o.responder)\n```\n* app a server from connect or express\n* url a uri where server status is provided, eg. '/status'\n\n## defaults.init.ops.pinger(optsArg)\n* optsArg\n\t* title: the printable name of the server being checked eg. 'My box'\n\t* url: the url for that server, eg. 'http://server.com/status'\n\t* period (optional, default 300): the number of seconds between each check\n\t* isPingerList (optional, default yes): if true the entire response is examined for times and consistency. If false, the response has to be error free and have status code 200\n\t* app the expected app identifier at that url\n\n## defaults.init.ops.shutDown()\nDeactivates the opsObject\n\n## loadDefaultFile()\nLoads ~/haraldops.json and returns the json object\n",
  "readmeFilename": "readme.md",
  "bugs": {
    "url": "https://github.com/haraldrudell/haraldops/issues"
  },
  "_id": "haraldops@0.1.10",
  "_from": "haraldops@>= 0.1.9"
}
