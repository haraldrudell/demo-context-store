webpackJsonp(["auth"],{"./app/actions/facebook.js":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(t){var a={data:e};return t((0,l.default)(d,(0,s.default)("/user/connect-facebook"),{body:a,headers:{"Content-Type":"application/json",Accept:"application/json"}}))}}function o(){return function(e){return(0,c.logSettingsEvent)({title:c.SETTINGS_PAGE_EVENTS.UPDATE_FACEBOOK_CONNECT_BEGAN,info:{enable:!1}}),e((0,l.default)(p,(0,s.default)("/user/disconnect-facebook")))}}Object.defineProperty(t,"__esModule",{value:!0}),t.facebookAuth=t.POST_DISCONNECT_FACEBOOK=t.POST_CONNECT_FACEBOOK=void 0,t.connectFacebook=r,t.disconnectFacebook=o;var i=a("./app/actions/api-request-action.js"),l=n(i),u=a("./app/utilities/json-api-url.js"),s=n(u),c=a("./app/analytics/index.js"),d=t.POST_CONNECT_FACEBOOK="POST_CONNECT_FACEBOOK",p=t.POST_DISCONNECT_FACEBOOK="POST_DISCONNECT_FACEBOOK";t.facebookAuth=function(){var e=window.FB;return new Promise(function(t,a){if(!e)return console.error("FB lib has not been initialized"),a();e.getLoginStatus(function(n){if("connected"===n.status)return t(n.authResponse);e.login(function(e){return e.authResponse?t(e.authResponse):a()})})})}},"./app/features/Auth/components/DeviceVerification/index.jsx":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,u,s,c,d,p,f=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),m=a("react"),h=n(m),b=a("./node_modules/prop-types/index.js"),E=n(b),g=a("./node_modules/lodash/get.js"),v=n(g),y=a("./node_modules/recompose/index.js"),_=a("./app/libs/with-preset/index.js"),R=a("./app/libs/with-routing/index.js"),x=a("./app/components/Layout/Block/index.jsx"),O=n(x),w=a("./app/components/Card/index.jsx"),T=n(w),C=a("./app/components/Text/index.jsx"),k=n(C),j=a("./app/components/LoadingSpinner/index.jsx"),A=n(j),I=a("./app/components/TextButton/index.jsx"),S=n(I),P=a("./app/components/Icon/index.jsx"),F=n(P),D=a("./app/utilities/with-redirect.js"),N=n(D),V=(l=(0,y.withProps)(function(e){return{isAttemptingVerification:Boolean((0,v.default)(e,"location.query.token"))}}),u=(0,_.withPreset)("verificationTokenExpired"),s=(0,_.withPreset)("otherDeviceVerified"),(0,R.withRouting)(c=l(c=u(c=s((p=d=function(e){function t(){var e,a,n,i;r(this,t);for(var l=arguments.length,u=Array(l),s=0;s<l;s++)u[s]=arguments[s];return a=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.renderVerificationAttemptFailure=function(){var e=n.props,t=e.redirectParam,a=e.verificationTokenExpired,r=a?"The verification link you opened has expired.":"We don’t recognize the verification link you opened.",o=t?(0,N.default)("/login",t):"/login";return h.default.createElement("div",null,h.default.createElement(O.default,{textAlign:"center",mb:2},h.default.createElement(F.default,{type:"warningLg",size:"xxxl",color:["navy","coral"]})),h.default.createElement(O.default,{mb:2},h.default.createElement(k.default,{align:"center",el:"p"},r)),h.default.createElement(k.default,{align:"center",el:"div"},h.default.createElement(S.default,{href:o},"Log in")," or"," ",h.default.createElement(S.default,{href:"https://patreon.zendesk.com/hc/en-us/requests/new"},"contact support"),"."))},n.renderVerificationSent=function(){var e=n.props,t=e.email,a=e.isLoading,r=e.onResendEmailToken;return h.default.createElement("div",null,h.default.createElement(O.default,{textAlign:"center",mb:2},h.default.createElement(F.default,{type:"devicesLg",size:"xxxl",color:["navy","coral"]})),h.default.createElement(O.default,{mb:2},h.default.createElement(k.default,{align:"center",el:"p"},"We need to verify this device to keep your account secure."," ",t?h.default.createElement("span",null,"We’ve sent an email to"," ",h.default.createElement(k.default,{weight:"bold"},t),"."):"We’ve sent you an email."," ","Open the link in the email to continue.")),h.default.createElement(O.default,{mb:2},h.default.createElement(k.default,{align:"center",el:"div"},"This email may take up to 5 minutes to be sent.")),h.default.createElement(k.default,{align:"center",el:"div"},"Can’t find the verification email?"),h.default.createElement(k.default,{align:"center",el:"div"},a?h.default.createElement(O.default,{display:"inline-block",mr:1},h.default.createElement(A.default,{size:"sm",color:"gray2",center:!1})):null,h.default.createElement(S.default,{href:"https://patreon.zendesk.com/hc/en-us/articles/115003578386-Not-receiving-emails-from-Patreon"},"Review your email filters")," ","or"," ",h.default.createElement(S.default,{onClick:function(){return r()},disabled:a},"Resend verification email")," "))},n.renderVerificationRequired=function(){var e=n.props.isAttemptingVerification;return h.default.createElement("div",null,h.default.createElement(k.default,{align:"center",scale:"2",el:"h1",weight:"bold"},"Verify this device"),h.default.createElement(T.default,null,e?n.renderVerificationAttemptFailure():n.renderVerificationSent()))},n.renderOtherDeviceVerified=function(){return h.default.createElement("div",null,h.default.createElement(k.default,{align:"center",scale:"2",el:"h1",weight:"bold"},"Device verified"),h.default.createElement(T.default,null,h.default.createElement(O.default,{textAlign:"center",mb:2},h.default.createElement(F.default,{type:"devicesLg",size:"xxxl",color:["navy","coral"]})),h.default.createElement(k.default,{align:"center",el:"p"},"We’ve successfully verified your other device. Log in again on the original device to continue.")))},i=a,o(n,i)}return i(t,e),f(t,[{key:"render",value:function(){return this.props.otherDeviceVerified?this.renderOtherDeviceVerified():this.renderVerificationRequired()}}]),t}(m.Component),d.propTypes={isAttemptingVerification:E.default.bool.isRequired,email:E.default.string,redirectParam:E.default.string,verificationTokenExpired:E.default.bool,otherDeviceVerified:E.default.bool,onResendEmailToken:E.default.func.isRequired,isLoading:E.default.bool.isRequired},c=p))||c)||c)||c)||c);t.default=V},"./app/features/Auth/components/ExpiredPasswordReset/index.jsx":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,u,s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),c=a("./node_modules/prop-types/index.js"),d=n(c),p=a("react"),f=n(p),m=a("./node_modules/lodash/get.js"),h=n(m),b=a("./app/components/Layout/Block/index.jsx"),E=n(b),g=a("./app/components/Button/index.jsx"),v=n(g),y=a("./app/components/CardWithHeader/index.jsx"),_=n(y),R=a("./app/components/Text/index.jsx"),x=n(R),O=a("./app/analytics/index.js"),w="password_leak",T="suspicious_activity",C=(u=l=function(e){function t(){var e,a,n,i;r(this,t);for(var l=arguments.length,u=Array(l),s=0;s<l;s++)u[s]=arguments[s];return a=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.renderReason=function(){return n.props.expireReason===w?f.default.createElement("div",null,f.default.createElement(x.default,{el:"p"},"To be super clear — your Patreon account is safe and sound, and we’re just expiring your password as a proactive security measure."),f.default.createElement(x.default,{el:"p"},"We found that your same username/password combination may have been compromised during a leak on another service. We hope you take this opportunity to create a new, stronger password for Patreon that is different from your passwords elsewhere.")):n.props.expireReason===T?f.default.createElement(x.default,{el:"p"},"We expire passwords from time to time as a proactive security measure. We detected suspicious activity in your account. To keep your account secure, we expired your password."):f.default.createElement(x.default,{el:"p"},"We expire passwords from time to time as a proactive security measure. To keep your account secure, we expired your password.")},n.renderInfoLink=function(){return n.props.expireReason===w?f.default.createElement(E.default,{mt:2},f.default.createElement(x.default,{el:"p"},f.default.createElement("a",{href:"https://patreon.zendesk.com/hc/en-us/articles/115005625346",target:"_blank"},"Learn more about protecting your password"))):null},n.renderSuccess=function(){return f.default.createElement(E.default,null,f.default.createElement(x.default,{el:"p"},f.default.createElement(x.default,{weight:"bold"},"Success!")),f.default.createElement(x.default,{el:"p"},"We sent a password reset link to"," ",f.default.createElement(x.default,{weight:"bold"},n.props.email),". This email may take a few minutes to arrive in your inbox."),n.renderInfoLink())},n.renderPrompt=function(){var e=(0,h.default)(n.props.forgotPassword,"request.isLoading");return f.default.createElement("div",null,f.default.createElement(E.default,{mb:2},f.default.createElement(x.default,{el:"h1",size:2},"Please create a new password. Safety first!")),f.default.createElement(E.default,{mb:4},n.renderReason()),f.default.createElement(v.default,{color:"blue",type:"submit",fluid:!0,block:!0,isLoading:e,onClick:n.handleClick},"Create New Password"))},n.handleClick=function(){(0,O.logExpiredPasswordEvent)({title:O.EXPIRED_PASSWORD_EVENTS.CLICKED_SEND_RESET_EMAIL}),n.props.forgotPassword.actions.post({data:{email:n.props.email,expired_password_email:!0}})},i=a,o(n,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=(0,h.default)(this.props.forgotPassword,"request.isLoaded");return f.default.createElement(_.default,{title:"Password Expired",size:"md",hasHeaderBorder:!0},e?this.renderSuccess():this.renderPrompt())}}]),t}(p.Component),l.propTypes={email:d.default.string.isRequired,forgotPassword:d.default.object.isRequired,expireReason:d.default.string},u);t.default=C},"./app/features/Auth/components/Login/index.jsx":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,u,s,c,d,p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},f=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),m=a("./node_modules/prop-types/index.js"),h=n(m),b=a("react"),E=n(b),g=a("./node_modules/react-recaptcha/dist/react-recaptcha.js"),v=n(g),y=a("./app/libs/reform/index.jsx"),_=n(y),R=a("./node_modules/recompose/index.js"),x=a("./node_modules/lodash/get.js"),O=n(x),w=a("./app/components/Button/index.jsx"),T=n(w),C=a("./app/components/ButtonWithIcon/index.jsx"),k=n(C),j=a("./app/components/Form/Input/index.jsx"),A=n(j),I=a("./app/components/Text/index.jsx"),S=n(I),P=a("./app/components/Card/index.jsx"),F=n(P),D=a("./app/components/Layout/Block/index.jsx"),N=n(D),V=a("./app/components/TextButton/index.jsx"),q=n(V),L=a("./app/features/Auth/reform-declarations/login.js"),M=n(L),U=a("./app/features/Auth/constants/index.js"),W=[{type:"email",name:"email",placeHolder:"Email",autoFocus:!0,icon:{type:"email",size:"xs",color:"gray3"}},{type:"password",name:"password",placeHolder:"Password",icon:{type:"key",size:"xs",color:"gray3"}},{type:"text",name:"twoFactorCode",placeHolder:"Two-Factor Code",autoFocus:!0,icon:{type:"lock",size:"xs",color:"gray3"}}],G=(l=(0,_.default)((0,M.default)("login")),u=(0,R.withState)("recaptchaVerified","setRecaptchaVerified",!1),l(s=u((d=c=function(e){function t(){var e,a,n,i;r(this,t);for(var l=arguments.length,u=Array(l),s=0;s<l;s++)u[s]=arguments[s];return a=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.submitHandler=function(e,t){e.preventDefault();var a=n.props.reform.login.model;return n.props.onSubmit(a,t),!1},n.contextHandler=function(e,t){return e.preventDefault(),n.props.onChangeContext(t),!1},n.onCaptchaVerify=function(e){var t=n.props,a=t.setRecaptchaVerified,r=t.onRecaptchaVerified;a(!0),r&&r(e)},n.isProbablyNotABot=function(){var e=n.props,t=e.recaptchaVerified;return!e.showRecaptcha||!!t},i=a,o(n,i)}return i(t,e),f(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.error,n=t.hideTitle,r=t.isLoading,o=t.onResendCode,i=t.showRecaptcha,l=t.smsTwoFactorMetaData,u=t.twoFactorRequired,s=this.props.reform.login,c=s.bindInput,d=s.dirtyState,f=s.model,m=s.validation,h=function(e){return"twoFactorCode"===e.name},b=function(e){return"email"===e.name||"password"===e.name},g=W.filter(u?h:b).map(function(e,t){var a=m.fields[e.name],n=(0,O.default)(a,"errors[0]",void 0),r=e.name in f,o=(0,O.default)(d,e.name+".hasBlurred",!1);return E.default.createElement(N.default,{mb:1,key:"input-"+e.name},E.default.createElement(A.default,p({},c(e.name),{autoFocus:!!e.autoFocus,type:e.type,label:e.placeHolder,icon:e.icon,error:o&&r&&n})))}),y=(0,O.default)(l,"phoneLastThree"),_=y?"We sent an SMS authentication code to your phone number ending in "+y:"Two-Factor authentication required",R=u?"Verify":"Log in",x=u?"gray1":"error",w=!m.isValid&&!u;return E.default.createElement("div",null,!n&&E.default.createElement(S.default,{align:"center",scale:"2",el:"h1",weight:"bold"},"Log in"),E.default.createElement(N.default,{mb:5},E.default.createElement(F.default,null,!u&&E.default.createElement("span",null,E.default.createElement(k.default,{icon:"socialRoundedFacebook",color:"facebookBlue",size:"md",iconSize:"xs",onClick:function(t){return e.submitHandler(t,U.FACEBOOK_LOGIN)},fluid:!0,block:!0,disabled:r},"Continue with Facebook"),E.default.createElement(N.default,{mv:4},E.default.createElement(S.default,{align:"center",el:"p",color:"gray3"},"or log in with email"))),u&&E.default.createElement(N.default,{mb:4},E.default.createElement(S.default,{align:"center",scale:"1",el:"p",color:x},_)),a&&"Two Factor Auth Required"!==a&&E.default.createElement(S.default,{align:"center",scale:"1",el:"p",color:"error","data-tag":"login-error"},a),E.default.createElement("form",{onSubmit:function(t){return e.submitHandler(t,U.LOGIN)},"data-tag":"login-form"},g,!u&&E.default.createElement(N.default,{mv:3},E.default.createElement(S.default,{align:"right",el:"div"},E.default.createElement(q.default,{onClick:function(t){return e.contextHandler(t,U.FORGOT_PASSWORD)}},"Forgot Password?"))),E.default.createElement(N.default,{mv:2},E.default.createElement("span",null,i&&E.default.createElement(v.default,{render:"explicit",onloadCallback:function(){},verifyCallback:this.onCaptchaVerify,sitekey:U.RECAPTCHA_KEY}))),E.default.createElement(N.default,{mv:2},E.default.createElement(T.default,{color:"blue",type:"submit",disabled:w,fluid:!0,block:!0,isLoading:r},R))),!u&&E.default.createElement(S.default,{align:"center",el:"div"},E.default.createElement(S.default,null,"New to Patreon? "),E.default.createElement(q.default,{onClick:function(t){return e.contextHandler(t,U.SIGNUP)}},"Sign Up")),!!u&&!!l&&E.default.createElement(S.default,{align:"center",el:"div"},E.default.createElement(q.default,{onClick:function(e){return o()}},"Resend verification code")))))}}]),t}(b.Component),c.propTypes={error:h.default.string,hideTitle:h.default.bool,isLoading:h.default.bool,onChangeContext:h.default.func,onRecaptchaVerified:h.default.func,onResendCode:h.default.func,onSubmit:h.default.func,recaptchaVerified:h.default.bool.isRequired,setRecaptchaVerified:h.default.func.isRequired,showRecaptcha:h.default.bool.isRequired,smsTwoFactorMetaData:h.default.object,twoFactorRequired:h.default.bool,reform:h.default.shape({login:h.default.shape({model:h.default.shape({email:h.default.string.isRequired,password:h.default.string.isRequired}).isRequired,bindInput:h.default.func.isRequired,dirtyState:h.default.object.isRequired,validation:h.default.object.isRequired}).isRequired}).isRequired},s=d))||s)||s);t.default=G},"./app/features/Auth/components/Signup/index.jsx":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,u,s,c,d,p,f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},m=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),h=a("./node_modules/prop-types/index.js"),b=n(h),E=a("react"),g=n(E),v=a("./node_modules/lodash/get.js"),y=n(v),_=a("./app/libs/reform/index.jsx"),R=n(_),x=a("./node_modules/react-recaptcha/dist/react-recaptcha.js"),O=n(x),w=a("./node_modules/recompose/index.js"),T=a("./app/components/Button/index.jsx"),C=n(T),k=a("./app/components/Layout/Block/index.jsx"),j=n(k),A=a("./app/components/Card/index.jsx"),I=n(A),S=a("./app/components/Form/Input/index.jsx"),P=n(S),F=a("./app/components/Text/index.jsx"),D=n(F),N=a("./app/components/TextButton/index.jsx"),V=n(N),q=a("./app/components/Form/Checkbox/index.jsx"),L=n(q),M=a("./app/components/ButtonWithIcon/index.jsx"),U=n(M),W=a("./app/features/Auth/reform-declarations/signup.js"),G=n(W),B=a("./app/features/Auth/constants/index.js"),H=[{type:"text",name:"name",label:"Full Name",icon:{type:"profile",size:"xs",color:"gray3"}},{type:"email",name:"email",label:"Email",icon:{type:"email",size:"xs",color:"gray3"}},{type:"email",name:"confirmEmail",label:"Confirm Email",icon:{type:"email",size:"xs",color:"gray3"}},{type:"password",name:"password",label:"Password",icon:{type:"key",size:"xs",color:"gray3"}}],z=(l=(0,R.default)((0,G.default)("signup")),u=(0,w.withState)("termsIsChecked","setTermIsChecked",!1),s=(0,w.withState)("recaptchaVerified","setRecaptchaVerified",!1),l(c=u(c=s((p=d=function(e){function t(){var e,a,n,i;r(this,t);for(var l=arguments.length,u=Array(l),s=0;s<l;s++)u[s]=arguments[s];return a=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.submitHandler=function(e,t){e.preventDefault();var a=n.props.reform.signup.model;return n.props.onSubmit(a,t),!1},n.contextHandler=function(e,t){return e.preventDefault(),n.props.onChangeContext(t),!1},n.onCaptchaVerify=function(e){var t=n.props,a=t.setRecaptchaVerified,r=t.onRecaptchaVerified;a(!0),r&&r(e)},n.isProbablyNotABot=function(){var e=n.props,t=e.recaptchaVerified;return!e.showRecaptcha||!!t},i=a,o(n,i)}return i(t,e),m(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.error,n=t.facebookEnabled,r=t.hideTitle,o=t.isLoading,i=t.onChangeContext,l=t.setTermIsChecked,u=t.showRecaptcha,s=t.termsIsChecked,c=this.props.reform.signup,d=c.bindInput,p=c.dirtyState,m=c.validation,h=c.model,b=n?"Finish signing up with Facebook by entering your e-mail address.":"or sign up with e-mail",E=m.fields.email.isValid,v=function(e){return!(n&&"name"===e.name||n&&"password"===e.name)},_=H.filter(v).map(function(e,t){var a=m.fields[e.name],n=(0,y.default)(a,"errors[0]",void 0),r=e.name in h,o=(0,y.default)(p,e.name+".hasBlurred",!1);return g.default.createElement(j.default,{pb:1,key:e.name},g.default.createElement(P.default,f({},d(e.name),{type:e.type,label:e.label,icon:e.icon,error:o&&r&&n})))});return g.default.createElement("div",null,!r&&g.default.createElement(D.default,{align:"center",scale:"2",el:"h1",weight:"bold"},"Sign Up"),g.default.createElement(j.default,{mb:5},g.default.createElement(I.default,null,!n&&g.default.createElement(U.default,{icon:"socialRoundedFacebook",color:"facebookBlue",size:"md",iconSize:"xs",onClick:function(t){return e.submitHandler(t,B.FACEBOOK_SIGNUP)},fluid:!0,block:!0,disabled:o},"Sign up with Facebook"),g.default.createElement(j.default,{mv:4},g.default.createElement(D.default,{align:"center",el:"p",color:"gray3"},b)),a&&g.default.createElement(D.default,{align:"center",scale:"1",el:"p",color:"error"},a),g.default.createElement("form",{onSubmit:function(t){return e.submitHandler(t,B.SIGNUP)},className:"mb-md"},_,g.default.createElement(j.default,{pv:2},g.default.createElement(L.default,{noMargin:!0,checked:s,onChange:function(e){return l(!s)},name:"tosagree",description:g.default.createElement("span",null,g.default.createElement(D.default,null,"You agree to our"," ",g.default.createElement(V.default,{onClick:function(e){return i(B.TERMS)}},"Terms of Use")))})),g.default.createElement(j.default,{mv:2},g.default.createElement("span",null,u&&g.default.createElement(O.default,{render:"explicit",onloadCallback:function(){},verifyCallback:this.onCaptchaVerify,sitekey:B.RECAPTCHA_KEY}))),g.default.createElement(j.default,{mv:2},g.default.createElement(C.default,{color:"blue",type:"submit",id:"patreon-normal-signup-button",disabled:!s||!this.isProbablyNotABot()||!n&&!m.isValid||!!n&&!E,fluid:!0,block:!0,isLoading:o},"Sign up"))),g.default.createElement(D.default,{align:"center",el:"div"},g.default.createElement(V.default,{onClick:function(t){return e.contextHandler(t,B.LOGIN)}},"Log in")))))}}]),t}(E.Component),d.propTypes={error:b.default.object,facebookEnabled:b.default.bool,hideTitle:b.default.bool,isLoading:b.default.bool,onRecaptchaVerified:b.default.func,onChangeContext:b.default.func,onSubmit:b.default.func.isRequired,recaptchaVerified:b.default.bool.isRequired,setRecaptchaVerified:b.default.func.isRequired,setTermIsChecked:b.default.func.isRequired,showRecaptcha:b.default.bool.isRequired,termsIsChecked:b.default.bool.isRequired,reform:b.default.shape({signup:b.default.shape({model:b.default.shape({email:b.default.string.isRequired,confirmEmail:b.default.string.isRequired,name:b.default.string.isRequired,password:b.default.string.isRequired}).isRequired,bindInput:b.default.func.isRequired,dirtyState:b.default.object.isRequired,validation:b.default.object.isRequired})}).isRequired},c=p))||c)||c)||c);t.default=z},"./app/features/Auth/constants/index.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SIGNUP="SIGNUP",t.LOGIN="LOGIN",t.TERMS="TERMS",t.FORGOT_PASSWORD="FORGOT_PASSWORD",t.FACEBOOK_SIGNUP="FACEBOOK_SIGNUP",t.FACEBOOK_LOGIN="FACEBOOK_LOGIN",t.DEVICE_VERIFICATION="DEVICE_VERIFICATION",t.PASSWORD_EXPIRATION="PASSWORD_EXPIRATION",t.EMAIL_REQUIRED_WITH_FACEBOOK="EmailRequiredWithFacebook",t.TOTP_TWO_FACTOR_REQUIRED="TOTPTwoFactorRequired",t.TWO_FACTOR_REQUIRED="TwoFactorRequired",t.SMS_TWO_FACTOR_REQUIRED="SMSTwoFactorRequired",t.INVALID_TOKEN="InvalidToken",t.TWO_FACTOR_INVALID="TwoFactorInvalid",t.CAPTCHA_REQUIRED="FlaggedAsBot",t.BAD_CAPTCHA="BadCaptcha",t.DEVICE_VERIFICATION_EMAIL_REQUIRED="DeviceVerificationViaEmailRequired",t.PASSWORD_EXPIRED="PasswordExpired",t.RECAPTCHA_KEY="6LeM_iEUAAAAANqpzY3A5ZzlYu0Ytwo-dHgZoLhn"},"./app/features/Auth/index.jsx":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,u,s,c,d,p,f=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},h=a("./node_modules/prop-types/index.js"),b=n(h),E=a("react"),g=n(E),v=a("./node_modules/reselect/lib/index.js"),y=a("./node_modules/react-redux/es/index.js"),_=a("./node_modules/lodash/get.js"),R=n(_),x=a("./app/utilities/csrf.js"),O=a("./app/libs/mallard/index.js"),w=n(O),T=a("./app/libs/reform/index.jsx"),C=a("./node_modules/nion/lib/index.js"),k=n(C),j=a("./app/utilities/json-api/index.js"),A=a("./app/actions/facebook.js"),I=a("./app/constants/google-analytics.js"),S=a("./app/features/Auth/mallard-declarations/auth.js"),P=n(S),F=a("./app/features/Auth/components/Signup/index.jsx"),D=n(F),N=a("./app/features/Auth/components/Login/index.jsx"),V=n(N),q=a("./app/features/Auth/components/DeviceVerification/index.jsx"),L=n(q),M=a("./app/features/Auth/components/ExpiredPasswordReset/index.jsx"),U=n(M),W=a("./app/features/Auth/constants/index.js"),G=a("./app/analytics/index.js"),B=a("./app/analytics/logger/index.js"),H=function(e){return(0,R.default)(e,"facebook.accessToken",null)},z=function(e){return(0,R.default)(e,"routing.location.query.ru",null)},K=function(e){return(0,R.default)((0,T.selectResourceForKey)("login")(e),"model.email",null)},Q=(0,v.createStructuredSelector)({facebookAuthToken:H,redirectParam:z,emailFromLoginForm:K}),X=function(e,t,a){return m({},a,e,t)},Y=(l=(0,k.default)({currentUser:{endpoint:(0,j.buildUrl)("/user",{})},smsVerification:{endpoint:(0,j.buildUrl)("/phones/send-verification"),apiType:"api"},deviceVerificationViaEmail:{endpoint:(0,j.buildUrl)("/device-verification/email/resend"),apiType:"api"},forgotPassword:{endpoint:(0,j.buildUrl)("/auth/forgot-password")}}),u=(0,y.connect)(Q,function(){return{}},X),s=(0,w.default)(function(e){return{auth:(0,P.default)("auth",e)}}),l(c=u(c=s((p=d=function(e){function t(){var e,a,n,i;r(this,t);for(var l=arguments.length,u=Array(l),s=0;s<l;s++)u[s]=arguments[s];return a=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.callLogEvent=function(e,t,a){var n={title:t};a&&(n.info={method:a}),e(n)},n.callGoogleAnalyticsEvent=function(e){(0,B.logBlogGoogleAnalyticsEvent)(e,I.GOOGLE_ANALYTICS_CONVERSION)},n.isLoading=function(){var e=n.props.isRedirecting,t=n.props.nion,a=t.smsVerification,r=t.currentUser,o=t.deviceVerificationViaEmail,i=(0,R.default)(r,"request.isLoading",!1),l=(0,R.default)(a,"request.isLoading",!1),u=(0,R.default)(o,"request.isLoading",!1);return i||l||u||e},n.onResendCode=function(){var e=n.props.mallard.auth.value.smsTwoFactorMetaData;n.props.nion.smsVerification.actions.post({data:{phone_last_three:e.phoneLastThree,phone_number_id:e.phoneNumberId,timestamp:e.timestamp,token:e.token}})},n.onResendEmailToken=function(){var e=n.props.mallard.auth.value.emailFactorMetaData;e&&n.props.nion.deviceVerificationViaEmail.actions.post({data:{verification_factor_email_id:e.verificationFactorEmailId,timestamp:e.timestamp,checksum:e.checksum,context:e.context,redirect_target:e.redirectTarget}})},n.onCaptchaVerified=function(e){var t=n.props.mallard.auth.actions.setCaptchaVerificationData;e&&t(e)},i=a,o(n,i)}return i(t,e),f(t,[{key:"componentWillReceiveProps",value:function(e){var t=(0,R.default)(this.props.nion,"currentUser.meta.csrf_token",(0,R.default)(this.props.nion,"currentUser.extra.meta.csrf_token",null));t&&(0,x.setCsrfSignature)(t)}},{key:"signup",value:function(e,t){var a=this,n=this.props.nion.currentUser;this.callLogEvent(G.logSignupEvent,G.SIGN_UP_EVENTS.SUBMITTED,t),n.actions.post(e.toRequest(),{endpoint:(0,j.buildUrl)("/user",{include:["campaign"]})}).then(function(e){a.callLogEvent(G.logSignupEvent,G.SIGN_UP_EVENTS.SUCCESS,t),a.props.onSuccess(e),a.callGoogleAnalyticsEvent(G.SIGN_UP_EVENTS.DOMAIN)}).catch(function(e){var n=(0,S.handleAuthError)(a.props.mallard.auth,e),r=n.sms,o=n.captcha,i=n.device;return r?(a.changeContext(W.LOGIN),void window.scrollTo(0,0)):i?(a.changeContext(W.DEVICE_VERIFICATION),void window.scrollTo(0,0)):void(o||a.callLogEvent(G.logSignupEvent,G.SIGN_UP_EVENTS.ERROR,t))})}},{key:"login",value:function(e,t){var a=this,n=this.props.nion.currentUser;this.callLogEvent(G.logLoginEvent,G.LOG_IN_EVENTS.SUBMITTED,t),n.actions.post(e.toRequest(),{endpoint:(0,j.buildUrl)("/login",{include:["campaign"]})}).then(function(e){a.callLogEvent(G.logLoginEvent,G.LOG_IN_EVENTS.SUCCESS,t),a.props.onSuccess(e)}).catch(function(e){var n=(0,S.handleAuthError)(a.props.mallard.auth,e),r=n.sms,o=n.captcha,i=n.device,l=n.passwordResetRequired;return r||o?void window.scrollTo(0,0):i?(a.changeContext(W.DEVICE_VERIFICATION),void window.scrollTo(0,0)):l?(a.changeContext(W.PASSWORD_EXPIRATION),void window.scrollTo(0,0)):void a.callLogEvent(G.logLoginEvent,G.LOG_IN_EVENTS.ERROR,t)})}},{key:"handleAuth",value:function(e,t){var a=this,n=this.props.mallard.auth.value,r=n.captchaVerificationData,o=n.facebookAuthToken,i=n.twoFactorRequired,l=this.props.mallard.auth.actions.setFacebookAuthToken,u=this.props.redirectParam,s=new j.JsonApiPayload("user",{email:Boolean(e.email)?e.email:void 0,password:Boolean(e.password)?e.password:void 0});r&&s.addAttribute("recaptcha_response_field",r),o&&s.addAttribute("fb_access_token",o),i&&s.addAttribute("two_factor_code",e.twoFactorCode),u&&s.addMetaAttribute("redirect_target",u),t===W.SIGNUP&&(s.addAttribute("name",e.name),this.signup(s,G.AUTH_METHODS.EMAIL)),t===W.LOGIN&&this.login(s,G.AUTH_METHODS.EMAIL),t===W.FACEBOOK_LOGIN&&(0,A.facebookAuth)().then(function(e){var t=(0,R.default)(e,"accessToken");l(t),s.addAttribute("fb_access_token",t),a.login(s,G.AUTH_METHODS.FACEBOOK)}),t===W.FACEBOOK_SIGNUP&&(0,A.facebookAuth)().then(function(t){var n=(0,R.default)(t,"accessToken");l(n),s.addAttribute("email",e.email),s.addAttribute("fb_access_token",n),e.password&&s.addAttribute("password",e.password),a.signup(s,G.AUTH_METHODS.FACEBOOK)})}},{key:"changeContext",value:function(e){var t=this.props.mallard.auth.actions.setDisplayForm;e===W.LOGIN&&(this.callLogEvent(G.logLoginEvent,G.LOG_IN_EVENTS.LANDED),t(W.LOGIN)),e===W.SIGNUP&&(this.callLogEvent(G.logSignupEvent,G.SIGN_UP_EVENTS.LANDED),t(W.SIGNUP)),e===W.DEVICE_VERIFICATION&&(this.callLogEvent(G.logSignupEvent,G.SIGN_UP_EVENTS.LANDED),t(W.DEVICE_VERIFICATION)),e===W.PASSWORD_EXPIRATION&&(this.callLogEvent(G.logExpiredPasswordEvent,G.EXPIRED_PASSWORD_EVENTS.LANDED),t(W.PASSWORD_EXPIRATION)),e===W.TERMS&&window.open("/legal","_blank"),e===W.FORGOT_PASSWORD&&window.open("/forgetPass","_blank"),this.props.onChangeContext&&this.props.onChangeContext(e)}},{key:"getError",value:function(){var e=(0,R.default)(this.props.nion.currentUser,"request.isError"),t=(0,R.default)(this.props.nion.currentUser,"request.errors"),a=(0,R.default)(t,"[0].detail")||(0,R.default)(t,"[0].title");return e&&a?a:e?"Something went wrong. We were unable to create or login your account.":void 0}},{key:"render",value:function(){var e=this,t=this.props.hideTitle,a=this.props.mallard.auth.value,n=a.captchaRequired,r=a.displayForm,o=a.emailRequiredWithFacebook,i=a.smsTwoFactorMetaData,l=a.twoFactorRequired,u=function(t,a){return e.handleAuth(t,a)},s=function(t){return e.changeContext(t)};return r===W.SIGNUP?g.default.createElement(D.default,{onSubmit:u,onChangeContext:s,isLoading:this.isLoading(),error:this.getError(),facebookEnabled:o,twoFactorRequired:l,hideTitle:t,showRecaptcha:n,onRecaptchaVerified:this.onCaptchaVerified}):r===W.DEVICE_VERIFICATION?g.default.createElement(L.default,{onResendEmailToken:this.onResendEmailToken,isLoading:this.isLoading(),redirectParam:this.props.redirectParam,email:this.props.emailFromLoginForm}):r===W.PASSWORD_EXPIRATION?g.default.createElement(U.default,{email:this.props.emailFromLoginForm,forgotPassword:this.props.nion.forgotPassword,expireReason:this.props.mallard.auth.value.passwordResetDetail}):g.default.createElement(V.default,{onSubmit:u,onChangeContext:s,isLoading:this.isLoading(),error:this.getError(),hideTitle:t,twoFactorRequired:l,smsTwoFactorMetaData:i,onResendCode:this.onResendCode,showRecaptcha:n,onRecaptchaVerified:this.onCaptchaVerified})}}]),t}(E.Component),d.propTypes={mallard:b.default.shape({auth:b.default.shape({value:b.default.shape({captchaRequired:b.default.bool.isRequired,captchaVerificationData:b.default.string,displayForm:b.default.string.isRequired,facebookAuthToken:b.default.string,twoFactorRequired:b.default.bool.isRequired,smsTwoFactorMetaData:b.default.object,emailRequiredWithFacebook:b.default.bool.isRequired,emailFactorMetaData:b.default.object,passwordResetRequired:b.default.bool.isRequired,passwordResetDetail:b.default.string}).isRequired,actions:b.default.shape({setDisplayForm:b.default.func.isRequired,setCaptchaRequired:b.default.func.isRequired,setCaptchaVerificationData:b.default.func.isRequired,setEmailRequiredWithFacebook:b.default.func.isRequired,setFacebookAuthToken:b.default.func.isRequired,setSmsTwoFactorMetaData:b.default.func.isRequired,setTwoFactorRequired:b.default.func.isRequired,setDeviceVerificationViaEmailRequired:b.default.func.isRequired,setEmailFactorMetaData:b.default.func.isRequired,setPasswordResetRequired:b.default.func.isRequired,setPasswordResetDetail:b.default.func.isRequired}).isRequired})}).isRequired,hideTitle:b.default.bool,onChangeContext:b.default.func,isRedirecting:b.default.bool,redirectParam:b.default.string,emailFromLoginForm:b.default.string,onSuccess:b.default.func},d.defaultProps={hideTitle:!0},c=p))||c)||c)||c);t.default=Y},"./app/features/Auth/mallard-declarations/auth.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleAuthError=void 0;var n=a("./node_modules/lodash/get.js"),r=function(e){return e&&e.__esModule?e:{default:e}}(n),o=a("./app/features/Auth/constants/index.js"),i=function(e){var t=(0,r.default)(e,"errors");return(0,r.default)(t,"[0].codeName")},l=function(e){var t=(0,r.default)(e,"errors");return(0,r.default)(t,"[0].detail")},u=function(e,t){var a=i(t),n=a===o.TWO_FACTOR_REQUIRED||a===o.TOTP_TWO_FACTOR_REQUIRED||a===o.SMS_TWO_FACTOR_REQUIRED;e.actions.setTwoFactorRequired(n||a===o.INVALID_TOKEN||a===o.TWO_FACTOR_INVALID);var l=(0,r.default)(t,"errors[0].meta");return l&&a===o.SMS_TWO_FACTOR_REQUIRED&&e.actions.setSmsTwoFactorMetaData(l),n},s=function(e,t){var a=i(t),n=a===o.DEVICE_VERIFICATION_EMAIL_REQUIRED;e.actions.setDeviceVerificationViaEmailRequired(n);var l=(0,r.default)(t,"errors[0].meta");return l&&a===o.DEVICE_VERIFICATION_EMAIL_REQUIRED&&e.actions.setEmailFactorMetaData(l),n},c=function(e,t){var a=i(t),n=a===o.CAPTCHA_REQUIRED;return e.actions.setCaptchaRequired(n),n},d=function(e,t){var a=i(t),n=a===o.EMAIL_REQUIRED_WITH_FACEBOOK;return e.actions.setEmailRequiredWithFacebook(n),n},p=function(e,t){var a=i(t),n=a===o.PASSWORD_EXPIRED;e.actions.setPasswordResetRequired(n);var r=l(t);return r&&a===o.PASSWORD_EXPIRED&&e.actions.setPasswordResetDetail(r),n};t.handleAuthError=function(e,t){return{sms:u(e,t),device:s(e,t),captcha:c(e,t),emailWithFacebook:d(e,t),passwordResetRequired:p(e,t)}},t.default=function(e,t){return{dataKey:e,initialValue:{displayForm:Boolean(t.displayForm)?t.displayForm:o.LOGIN,facebookAuthToken:t.facebookAuthToken,captchaRequired:t.showRecaptcha,captchaVerificationData:void 0,twoFactorRequired:!1,smsTwoFactorMetaData:void 0,emailRequiredWithFacebook:!1,deviceVerificationViaEmailRequired:!1,emailFactorMetaData:void 0,passwordResetRequired:!1,passwordResetDetail:void 0},actions:{setCaptchaRequired:function(e,t){return e.set("captchaRequired",t)},setCaptchaVerificationData:function(e,t){return e.set("captchaVerificationData",t)},setDisplayForm:function(e,t){return e.set("displayForm",t)},setFacebookAuthToken:function(e,t){return e.set("facebookAuthToken",t)},setTwoFactorRequired:function(e,t){return e.set("twoFactorRequired",t)},setSmsTwoFactorMetaData:function(e,t){return e.set("smsTwoFactorMetaData",t)},setEmailRequiredWithFacebook:function(e,t){return e.set("emailRequiredWithFacebook",t)},setDeviceVerificationViaEmailRequired:function(e,t){return e.set("deviceVerificationViaEmailRequired",t)},setEmailFactorMetaData:function(e,t){return e.set("emailFactorMetaData",t)},setPasswordResetRequired:function(e,t){return e.set("passwordResetRequired",t)},setPasswordResetDetail:function(e,t){return e.set("passwordResetDetail",t)}}}}},"./app/features/Auth/reform-declarations/login.js":function(e,t,a){"use strict";function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Object.defineProperty(t,"__esModule",{value:!0});var r=a("./app/libs/reform/src/validation/index.js"),o=a("./app/libs/reform/src/validation/helpers.js");t.default=function(e){return n({},e,{dataKey:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"login",initialModel:{email:"",password:""},validation:{email:(0,o.validateOrFail)([{rules:[(0,r.type)("string"),r.email],errorResult:"Please enter a valid email."}]),password:(0,o.validateOrFail)([{rules:[(0,r.type)("string"),(0,r.minLength)(1)],errorResult:"Please enter a password."}])}})}},"./app/features/Auth/reform-declarations/signup.js":function(e,t,a){"use strict";function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Object.defineProperty(t,"__esModule",{value:!0});var r=a("./app/libs/reform/src/validation/index.js"),o=a("./app/libs/reform/src/validation/helpers.js");t.default=function(e){return n({},e,{dataKey:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"signup",initialModel:{name:"",email:"",confirmEmail:"",password:""},validation:{name:(0,o.validateOrFail)([{rules:[(0,r.type)("string"),(0,r.minLength)(1)],errorResult:"Name is required."}]),email:(0,o.validateOrFail)([{rules:[(0,r.type)("string"),r.email],errorResult:"Please enter a valid email."}]),confirmEmail:(0,o.validateOrFail)([{rules:[(0,r.type)("string"),r.email,(0,r.valuesAreEqual)("email")],errorResult:"Your email confirmation does not match."}]),password:(0,o.validateOrFail)([{rules:[(0,r.type)("string"),(0,r.minLength)(6)],errorResult:"Password needs to be at least 6 characters."}])}})}},"./app/pages/auth/client-render.js":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},o=a("react"),i=n(o),l=a("./app/shared/render-page/index.js"),u=n(l),s=a("./app/shared/configure-store/index.js"),c=n(s),d=a("./node_modules/react-router/es/index.js"),p=a("./app/pages/auth/routes.jsx");t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,c.default)({},{router:{initialRoute:e.route}}),a=t.store,n=t.history,o=(0,p.makeRoutes)(a),l=function(){return i.default.createElement(d.Router,{history:n},o)};return(0,u.default)(l,r({store:a},e))}},"./app/pages/auth/components/App/index.jsx":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,u,s,c,d,p=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),f=a("./node_modules/prop-types/index.js"),m=n(f),h=a("react"),b=n(h),E=a("./node_modules/reselect/lib/index.js"),g=a("./node_modules/react-router/es/index.js"),v=a("./node_modules/react-redux/es/index.js"),y=a("./node_modules/recompose/index.js"),_=a("./node_modules/lodash/get.js"),R=n(_),x=a("./app/libs/with-preset/index.js"),O=a("./app/components/Layout/Grid/index.jsx"),w=n(O),T=a("./app/features/Auth/constants/index.js"),C=a("./app/utilities/sanitize-url.js"),k=n(C),j=a("./app/analytics/index.js"),A=a("./app/shared/events/auth.js"),I="/login",S="/signup",P="/auth/verify-device",F="/home",D=(0,E.createStructuredSelector)({mainServer:(0,x.selectPreset)("mainServer"),redirectUrl:(0,x.selectPreset)("redirectUrl","/home"),showRecaptcha:(0,x.selectPreset)("showCaptcha",!1)}),N=(l=(0,v.connect)(D),u=(0,y.withState)("isRedirecting","setIsRedirecting",!1),l(s=u((d=c=function(e){function t(e){r(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.onAuthSuccess=function(e){var t=a.props,n=t.redirectUrl,r=t.mainServer,o=t.setIsRedirecting,i=(0,R.default)(e,"campaign"),l=(0,R.default)(i,"publishedAt");o(!0);var u=n;!u&&i&&l&&(u=F);var s=""+r+u;0!==u.indexOf("https://")&&0!==u.indexOf("http://")||(s=u),window.location.href=(0,k.default)(s)},a.onChangeContext=function(e){e===T.LOGIN?g.browserHistory.push(I):e===T.PASSWORD_EXPIRATION?g.browserHistory.push(I):e===T.DEVICE_VERIFICATION?g.browserHistory.push(P):g.browserHistory.push(S)},(0,A.logAuthEvent)(j.AUTH_EVENTS.LANDED,{page:"auth"}),a}return i(t,e),p(t,[{key:"render",value:function(){var e=this.props,t=e.showRecaptcha,a=e.isRedirecting,n=this.props.children,r=T.LOGIN;n.props.location.pathname===S?r=T.SIGNUP:n.props.location.pathname===P&&(r=T.DEVICE_VERIFICATION);var o={hideTitle:!1,onSuccess:this.onAuthSuccess,onChangeContext:this.onChangeContext,isRedirecting:a,displayForm:r,showRecaptcha:t},i=n&&b.default.cloneElement(n,o);return b.default.createElement("div",{className:"containerInner fullWidthMobile"},b.default.createElement(w.default,{maxWidth:"sm",ph:{xs:0,sm:0},pv:{xs:2,sm:2}},i))}}]),t}(h.Component),c.propTypes={children:m.default.node,isRedirecting:m.default.bool,mainServer:m.default.string,redirectUrl:m.default.string,setIsRedirecting:m.default.func,showRecaptcha:m.default.bool},s=d))||s)||s);t.default=N},"./app/pages/auth/index.js":function(e,t,a){"use strict";var n=a("./app/pages/auth/client-render.js");(0,function(e){return e&&e.__esModule?e:{default:e}}(n).default)()},"./app/pages/auth/routes.jsx":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.makeRoutes=void 0;var r=a("react"),o=n(r),i=a("./node_modules/react-router/es/index.js"),l=a("./app/pages/auth/components/App/index.jsx"),u=n(l),s=a("./app/features/Auth/index.jsx"),c=n(s);t.makeRoutes=function(e){return o.default.createElement(i.Route,{path:"/",component:u.default},o.default.createElement(i.Route,{path:"login",key:"login",component:c.default}),o.default.createElement(i.Route,{path:"signup",key:"signup",component:c.default}),o.default.createElement(i.Route,{path:"auth/verify-device",key:"device-verification",component:c.default}))}},"./app/shared/events/auth.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logAuthEvent=void 0;var n=a("./app/analytics/index.js");t.logAuthEvent=function(e,t){return(0,n.logEvent)({domain:n.AUTH_EVENTS.DOMAIN,title:e,info:t})}},"./node_modules/react-recaptcha/dist/react-recaptcha.js":function(e,t,a){!function(t,n){e.exports=function(e){return function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),u=a(6),s=n(u),c=a(4),d=n(c),p={className:d.default.string,onloadCallbackName:d.default.string,elementID:d.default.string,onloadCallback:d.default.func,verifyCallback:d.default.func,expiredCallback:d.default.func,render:d.default.string,sitekey:d.default.string,theme:d.default.string,type:d.default.string,verifyCallbackName:d.default.string,expiredCallbackName:d.default.string,size:d.default.string,tabindex:d.default.string,hl:d.default.string,badge:d.default.string},f={elementID:"g-recaptcha",onloadCallback:void 0,onloadCallbackName:"onloadCallback",verifyCallback:void 0,verifyCallbackName:"verifyCallback",expiredCallback:void 0,expiredCallbackName:"expiredCallback",render:"onload",theme:"light",type:"image",size:"normal",tabindex:"0",hl:"en",badge:"bottomright"},m=function(){return"undefined"!=typeof window&&void 0!==window.grecaptcha},h=void 0,b=function(e){function t(e){r(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a._renderGrecaptcha=a._renderGrecaptcha.bind(a),a.reset=a.reset.bind(a),a.state={ready:m(),widget:null},a.state.ready||(h=setInterval(a._updateReadyState.bind(a),1e3)),a}return i(t,e),l(t,[{key:"componentDidMount",value:function(){this.state.ready&&this._renderGrecaptcha()}},{key:"componentDidUpdate",value:function(e,t){var a=this.props,n=a.render,r=a.onloadCallback;"explicit"===n&&r&&this.state.ready&&!t.ready&&this._renderGrecaptcha()}},{key:"componentWillUnmount",value:function(){clearInterval(h)}},{key:"reset",value:function(){var e=this.state,t=e.ready,a=e.widget;t&&null!==a&&grecaptcha.reset(a)}},{key:"_updateReadyState",value:function(){m()&&(this.setState({ready:!0}),clearInterval(h))}},{key:"_renderGrecaptcha",value:function(){this.state.widget=grecaptcha.render(this.props.elementID,{sitekey:this.props.sitekey,callback:this.props.verifyCallback?this.props.verifyCallback:void 0,theme:this.props.theme,type:this.props.type,size:this.props.size,tabindex:this.props.tabindex,hl:this.props.hl,badge:this.props.badge,"expired-callback":this.props.expiredCallback?this.props.expiredCallback:void 0}),this.props.onloadCallback&&this.props.onloadCallback()}},{key:"render",value:function(){return"explicit"===this.props.render&&this.props.onloadCallback?s.default.createElement("div",{id:this.props.elementID,"data-onloadcallbackname":this.props.onloadCallbackName,"data-verifycallbackname":this.props.verifyCallbackName}):s.default.createElement("div",{id:this.props.elementID,className:"g-recaptcha","data-sitekey":this.props.sitekey,"data-theme":this.props.theme,"data-type":this.props.type,"data-size":this.props.size,"data-badge":this.props.badge,"data-tabindex":this.props.tabindex})}}]),t}(u.Component);t.default=b,b.propTypes=p,b.defaultProps=f,e.exports=t.default},function(e,t){"use strict";function a(e){return function(){return e}}var n=function(){};n.thatReturns=a,n.thatReturnsFalse=a(!1),n.thatReturnsTrue=a(!0),n.thatReturnsNull=a(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(e){return e},e.exports=n},function(e,t,a){"use strict";function n(e,t,a,n,o,i,l,u){if(r(t),!e){var s;if(void 0===t)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[a,n,o,i,l,u],d=0;s=new Error(t.replace(/%s/g,function(){return c[d++]})),s.name="Invariant Violation"}throw s.framesToPop=1,s}}var r=function(e){};e.exports=n},function(e,t,a){"use strict";var n=a(1),r=a(2),o=a(5);e.exports=function(){function e(e,t,a,n,i,l){l!==o&&r(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var a={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t};return a.checkPropTypes=n,a.PropTypes=a,a}},function(e,t,a){e.exports=a(3)()},function(e,t){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(t,a){t.exports=e}])}(a("react"))}()},"multi babel-polyfill /root/patreon_react_features/app/pages/auth/index.js":function(e,t,a){a("./node_modules/babel-polyfill/lib/index.js"),e.exports=a("./app/pages/auth/index.js")},react:function(e,t){e.exports=React},"react-dom":function(e,t){e.exports=ReactDOM}},["multi babel-polyfill /root/patreon_react_features/app/pages/auth/index.js"]);
//# sourceMappingURL=auth.deec0f4c7ed4f2d1a34a.bundle.js.map