// initialize the bluecore object
var environment = (window.location.host === "m.sephora.com" || window.location.host === "www.sephora.com") ? "prod" : "dev";

window.bluecore = window.bluecore || {}, bluecore.load = function(e,r,c) { bluecore.env = r || "prod", bluecore.namespace = e, bluecore.opts = c || {} }; bluecore.load('sephora', environment);

(function(){
    setTimeout(function(){
        bt_log("Bluecore ready");
	    Sephora.analytics.resolvePromises.bluecoreReady();
	    
	    // Fire merged event ILLUPH-86082
	    var user_id = digitalData.user[0].profile[0].profileInfo.profileID; // This ID is only populated if we really know who they are; it is falsey if we don't know their true ATG_id. No Temporary IDs.
        if (user_id){
            var merge_flag = 'bc_merged';
            var merged = triggermail.lytics.cookie.props[merge_flag];
        if (! merged ){
            var distinct_id = triggermail.lytics.cookie.props.distinct_id;
            triggermail.track('merge',{
                merge : {
                    source: distinct_id,
                    destination: user_id
                }
            });
            triggermail.lytics.cookie.props[merge_flag] = true;
            triggermail.lytics.cookie.props.distinct_id = user_id;
            triggermail.lytics.cookie.save();
            }
        }
	}, 1000)
}())

// do not edit anything below this line because it is third party authored.

window.jQuery||function(){var D=document.createElement("script");D.type="text/javascript";D.src=("https:"===document.location.protocol?"https://":"http://")+"ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js";var F=document.getElementsByTagName("script")[0];F.parentNode.insertBefore(D,F)}();
function __xx_checkJquery(){if(window.jQuery){(function(){var a=!1,b=/var xyz/.test(function(){})?/\b_super\b/:/[\D|\d]*/;this.__tmClass=function(){};window.__tmClass=this.__tmClass;__tmClass.extend=function(c){function e(){!a&&this.init&&this.init.apply(this,arguments)}var f=this.prototype;a=!0;var h=new this;a=!1;for(var p in c)h[p]="function"==typeof c[p]&&"function"==typeof f[p]&&b.test(c[p])?function(a,c){return function(){var b=this._super;this._super=f[a];var e=c.apply(this,arguments);this._super=
b;return e}}(p,c[p]):c[p];e.prototype=h;e.prototype.constructor=e;e.extend=arguments.callee;return window.__tmClass=e}})();window.triggermail={};window.console?"undefined"==typeof window.console.debug&&(console.debug=function(){}):console={debug:function(){},error:function(){},log:function(){}};window.TM_API_HOST="triggeredmail.appspot.com/api";window.triggermail.lytics=[];triggermail.lytics.__SV=1.2;(function(a){function b(){b.done||(L=b.done=!0,y=!1,d.each(E,function(g){g._dom_loaded()}))}var c=
Array.prototype,e=Object.prototype,f=c.slice,h=e.toString,p=e.hasOwnProperty,m=window.console,u=window.navigator,l=window.document,n=u.userAgent,C=["__mps","__mpa","__mpap","$people_distinct_id","__alias"],w=!1;try{w=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(q){}var z="https:"==l.location.protocol?"https://":"http://",e=a&&a.__SV||0,B=w,y=!B&&-1==n.indexOf("MSIE"),d={},t=!1,N={api_host:z+TM_API_HOST,cross_subdomain_cookie:!0,cookie_name:"",loaded:function(){},store_google:!1,
save_referrer:!0,test:!1,verbose:!1,img:!1,track_pageview:!0,debug:!1,live_demo:!1,track_links_timeout:300,cookie_expiration:365,upgrade:!1,disable_cookie:!1,ip:!0},L=!1;(function(){var g=c.forEach,a=c.indexOf,s=Array.isArray,b={},K=d.each=function(a,A,d){if(null!=a)if(g&&a.forEach===g)a.forEach(A,d);else if(a.length===+a.length)for(var s=0,c=a.length;s<c&&!(s in a&&A.call(d,a[s],s,a)===b);s++);else for(s in a)if(p.call(a,s)&&A.call(d,a[s],s,a)===b)break};d.extend=function(g){K(f.call(arguments,1),
function(a){for(var A in a)void 0!==a[A]&&(g[A]=a[A])});return g};d.isArray=s||function(g){return"[object Array]"===h.call(g)};d.isFunction=function(g){try{return/^\s*\bfunction\b/.test(g)}catch(a){return!1}};d.isArguments=function(g){return!(!g||!p.call(g,"callee"))};d.toArray=function(g){return!g?[]:g.toArray?g.toArray():d.isArray(g)||d.isArguments(g)?f.call(g):d.values(g)};d.values=function(g){var a=[];if(null==g)return a;K(g,function(g){a[a.length]=g});return a};d.identity=function(g){return g};
d.include=function(g,d){var s=!1;if(null==g)return s;if(a&&g.indexOf===a)return-1!=g.indexOf(d);K(g,function(g){if(s||(s=g===d))return b});return s};d.includes=function(g,a){return-1!==g.indexOf(a)}})();d.inherit=function(g,a){g.prototype=new a;g.prototype.constructor=g;g.superclass=a.prototype;return g};d.isObject=function(g){return g===Object(g)&&!d.isArray(g)};d.isEmptyObject=function(g){if(d.isObject(g)){for(var a in g)if(p.call(g,a))return!1;return!0}return!1};d.isUndefined=function(g){return void 0===
g};d.isString=function(g){return"[object String]"==h.call(g)};d.isDate=function(g){return"[object Date]"==h.call(g)};d.isNumber=function(g){return"[object Number]"==h.call(g)};d.encodeDates=function(g){d.each(g,function(a,s){d.isDate(a)?g[s]=d.formatDate(a):d.isObject(a)&&(g[s]=d.encodeDates(a))});return g};d.formatDate=function(g){function a(g){return 10>g?"0"+g:g}return g.getUTCFullYear()+"-"+a(g.getUTCMonth()+1)+"-"+a(g.getUTCDate())+"T"+a(g.getUTCHours())+":"+a(g.getUTCMinutes())+":"+a(g.getUTCSeconds())};
d.strip_empty_properties=function(g){var a={};d.each(g,function(g,c){d.isString(g)&&0<g.length&&(a[c]=g)});return a};d.truncate=function(g,a){var s;"string"===typeof g?s=g.slice(0,a):d.isArray(g)?(s=[],d.each(g,function(g){s.push(d.truncate(g,a))})):d.isObject(g)?(s={},d.each(g,function(g,c){s[c]=d.truncate(g,a)})):s=g;return s};d.JSONEncode=function(){return function(g){var a=function(g){var a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
d={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};a.lastIndex=0;return a.test(g)?'"'+g.replace(a,function(g){var a=d[g];return"string"===typeof a?a:"\\u"+("0000"+g.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+g+'"'},d=function(g,c){var b="",f=0,e=f="",e=0,l=b,t=[],k=c[g];switch(typeof k){case "string":return a(k);case "number":return isFinite(k)?String(k):"null";case "boolean":case "null":return String(k);case "object":if(!k)return"null";b+="    ";t=[];if("[object Array]"===
h.apply(k)){e=k.length;for(f=0;f<e;f+=1)t[f]=d(f,k)||"null";return e=0===t.length?"[]":b?"[\n"+b+t.join(",\n"+b)+"\n"+l+"]":"["+t.join(",")+"]"}for(f in k)p.call(k,f)&&(e=d(f,k))&&t.push(a(f)+(b?": ":":")+e);return e=0===t.length?"{}":b?"{"+t.join(",")+""+l+"}":"{"+t.join(",")+"}"}};return d("",{"":g})}}();d.JSONDecode=function(){var g,a,d={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},c,b=function(a){throw{name:"SyntaxError",message:a,at:g,text:c};},f=function(d){d&&d!==a&&b("Expected '"+
d+"' instead of '"+a+"'");a=c.charAt(g);g+=1;return a},e=function(){var g;g="";"-"===a&&(g="-",f("-"));for(;"0"<=a&&"9">=a;)g+=a,f();if("."===a)for(g+=".";f()&&"0"<=a&&"9">=a;)g+=a;if("e"===a||"E"===a){g+=a;f();if("-"===a||"+"===a)g+=a,f();for(;"0"<=a&&"9">=a;)g+=a,f()}g=+g;if(isFinite(g))return g;b("Bad number")},l=function(){var g,c,e="",H;if('"'===a)for(;f();){if('"'===a)return f(),e;if("\\"===a)if(f(),"u"===a){for(c=H=0;4>c;c+=1){g=parseInt(f(),16);if(!isFinite(g))break;H=16*H+g}e+=String.fromCharCode(H)}else if("string"===
typeof d[a])e+=d[a];else break;else e+=a}b("Bad string")},h=function(){for(;a&&" ">=a;)f()},t=function(){switch(a){case "t":return f("t"),f("r"),f("u"),f("e"),!0;case "f":return f("f"),f("a"),f("l"),f("s"),f("e"),!1;case "n":return f("n"),f("u"),f("l"),f("l"),null}b("Unexpected '"+a+"'")},k;k=function(){h();switch(a){case "{":var g;a:{var d={};if("{"===a){f("{");h();if("}"===a){f("}");g=d;break a}for(;a;){g=l();h();f(":");Object.hasOwnProperty.call(d,g)&&b('Duplicate key "'+g+'"');d[g]=k();h();if("}"===
a){f("}");g=d;break a}f(",");h()}}b("Bad object");g=void 0}return g;case "[":a:{g=[];if("["===a){f("[");h();if("]"===a){f("]");break a}for(;a;){g.push(k());h();if("]"===a){f("]");break a}f(",");h()}}b("Bad array");g=void 0}return g;case '"':return l();case "-":return e();default:return"0"<=a&&"9">=a?e():t()}};return function(d){c=d;g=0;a=" ";d=k();h();a&&b("Syntax error");return d}}();d.base64Encode=function(g){var a,s,c,b,f=0,e=0,l="",l=[];if(!g)return g;g=d.utf8Encode(g);do a=g.charCodeAt(f++),
s=g.charCodeAt(f++),c=g.charCodeAt(f++),b=a<<16|s<<8|c,a=b>>18&63,s=b>>12&63,c=b>>6&63,b&=63,l[e++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(s)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b);while(f<g.length);l=l.join("");switch(g.length%3){case 1:l=l.slice(0,-2)+"==";break;case 2:l=
l.slice(0,-1)+"="}return l};d.utf8Encode=function(g){g=(g+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var a="",d,b,c=0,f;d=b=0;c=g.length;for(f=0;f<c;f++){var e=g.charCodeAt(f),l=null;128>e?b++:l=127<e&&2048>e?String.fromCharCode(e>>6|192,e&63|128):String.fromCharCode(e>>12|224,e>>6&63|128,e&63|128);null!==l&&(b>d&&(a+=g.substring(d,b)),a+=l,d=b=f+1)}b>d&&(a+=g.substring(d,g.length));return a};d.UUID=function(){var g=function(){for(var g=1*new Date,a=0;g==1*new Date;)a++;return g.toString(16)+a.toString(16)},
a=function(g){function a(g,d){var c,s=0;for(c=0;c<d.length;c++)s|=b[c]<<8*c;return g^s}var d,b=[],c=0;for(g=0;g<n.length;g++)d=n.charCodeAt(g),b.unshift(d&255),4<=b.length&&(c=a(c,b),b=[]);0<b.length&&(c=a(c,b));return c.toString(16)};return function(){var d=(screen.height*screen.width).toString(16);return g()+"-"+Math.random().toString(16).replace(".","")+"-"+a()+"-"+d+"-"+g()}}();d.isBlockedUA=function(){return/(google web preview|baiduspider|yandexbot)/i.test(n)?!0:!1};d.HTTPBuildQuery=function(g,
a){var b,c,f=[];"undefined"===typeof a&&(a="&");d.each(g,function(g,a){b=encodeURIComponent(g.toString());c=encodeURIComponent(a);f[f.length]=c+"="+b});return f.join(a)};d.getQueryParam=function(g,a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var d=RegExp("[\\?&]"+a+"=([^&#]*)").exec(g);return null===d||d&&"string"!==typeof d[1]&&d[1].length?"":decodeURIComponent(d[1]).replace(/\+/g," ")};d.cookie={get:function(g){g+="=";for(var a=l.cookie.split(";"),d=0;d<a.length;d++){for(var b=a[d];" "==b.charAt(0);)b=
b.substring(1,b.length);if(0==b.indexOf(g))return decodeURIComponent(b.substring(g.length,b.length))}return null},parse:function(g){var a;try{a=d.JSONDecode(d.cookie.get(g))||{}}catch(b){}return a},set:function(g,a,d,b){var c="",f="";b&&(c=(c=(c=l.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i))?c[0]:"")?"; domain=."+c:"");d&&(f=new Date,f.setTime(f.getTime()+864E5*d),f="; expires="+f.toGMTString());l.cookie=g+"="+encodeURIComponent(a)+f+"; path=/"+c},remove:function(g,a){d.cookie.set(g,
"",-1,a)}};d.register_event=function(){function g(g,b,c){return function(f){var e=f;f=f||a(window.event);var l,h;"undefined"!==typeof f&&(h=b.call(g,f));d.isFunction(c)&&(l=c(e));f=!0;if(!1===l||!1===h)f=!1;return f}}function a(g){g&&(g.preventDefault=a.preventDefault,g.stopPropagation=a.stopPropagation);return g}a.preventDefault=function(){this.returnValue=!1};a.stopPropagation=function(){this.cancelBubble=!0};return function(a,d,b,c){a?a.addEventListener&&!c?a.addEventListener(d,b,!1):(d="on"+d,
a[d]=g(a,b,a[d])):x.error("No valid element provided to register_event")}}();d.dom_query=function(){function g(g,d){return 0<=(" "+g.className+" ").replace(a," ").indexOf(" "+d+" ")}var a=/[\t\r\n]/g;return function(a){if(!l.getElementsByTagName)return[];a=a.split(" ");for(var b,c=Array(l),f=0;f<a.length;f++)if(b=a[f].replace(/^\s+/,"").replace(/\s+$/,""),-1<b.indexOf("#")){b=b.split("#");var e=b[0],c=l.getElementById(b[1]);if(!c||e&&c.nodeName.toLowerCase()!=e)return[];c=Array(c)}else if(-1<b.indexOf(".")){b=
b.split(".");var e=b[0],A=b[1];e||(e="*");b=[];for(var h=0,k=0;k<c.length;k++){var t;t="*"==e?c[k].all?c[k].all:c[k].getElementsByTagName("*"):c[k].getElementsByTagName(e);for(var n=0;n<t.length;n++)b[h++]=t[n]}c=[];for(h=e=0;h<b.length;h++)b[h].className&&(d.isString(b[h].className)&&g(b[h],A))&&(c[e++]=b[h])}else if(b.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/)){var e=RegExp.$1,m=RegExp.$2,A=RegExp.$3,p=RegExp.$4;e||(e="*");b=[];for(k=h=0;k<c.length;k++){t="*"==e?c[k].all?c[k].all:c[k].getElementsByTagName("*"):
c[k].getElementsByTagName(e);for(n=0;n<t.length;n++)b[h++]=t[n]}c=[];e=0;switch(A){case "=":A=function(a){return a.getAttribute(m)==p};break;case "~":A=function(a){return a.getAttribute(m).match(RegExp("\\b"+p+"\\b"))};break;case "|":A=function(a){return a.getAttribute(m).match(RegExp("^"+p+"-?"))};break;case "^":A=function(a){return 0==a.getAttribute(m).indexOf(p)};break;case "$":A=function(a){return a.getAttribute(m).lastIndexOf(p)==a.getAttribute(m).length-p.length};break;case "*":A=function(a){return-1<
a.getAttribute(m).indexOf(p)};break;default:A=function(a){return a.getAttribute(m)}}c=[];for(h=e=0;h<b.length;h++)A(b[h])&&(c[e++]=b[h])}else{e=b;b=[];for(k=h=0;k<c.length;k++){t=c[k].getElementsByTagName(e);for(n=0;n<t.length;n++)b[h++]=t[n]}c=b}return c}}();d.info={campaignParams:function(){var a="",b={};d.each(["utm_source","utm_medium","utm_campaign","utm_content","utm_term"],function(c){a=d.getQueryParam(l.URL,c);a.length&&(b[c]=a)});return b},searchEngine:function(a){return 0===a.search("https?://(.*)google.([^/?]*)")?
"google":0===a.search("https?://(.*)bing.com")?"bing":0===a.search("https?://(.*)yahoo.com")?"yahoo":0===a.search("https?://(.*)duckduckgo.com")?"duckduckgo":null},searchInfo:function(a){var b=d.info.searchEngine(a),c={};null!==b&&(c.g_search_engine=b,a=d.getQueryParam(a,"yahoo"!=b?"q":"p"),a.length&&(c.mp_keyword=a));return c},browser:function(){var a=u.vendor||"";return window.opera?d.includes(n,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(n)?"BlackBerry":d.includes(n,"Chrome")?
"Chrome":d.includes(a,"Apple")?d.includes(n,"Mobile")?"Mobile Safari":"Safari":d.includes(n,"Android")?"Android Mobile":d.includes(n,"Konqueror")?"Konqueror":d.includes(n,"Firefox")?"Firefox":d.includes(n,"MSIE")?"Internet Explorer":d.includes(n,"Gecko")?"Mozilla":""},os:function(){return/Windows/i.test(n)?/Phone/.test(n)?"Windows Mobile":"Windows":/(iPhone|iPad|iPod)/.test(n)?"iOS":/Android/.test(n)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(n)?"BlackBerry":/Mac/i.test(n)?"Mac OS X":/Linux/.test(n)?
"Linux":""},device:function(){return/iPhone/.test(n)?"iPhone":/iPad/.test(n)?"iPad":/iPod/.test(n)?"iPod Touch":/(BlackBerry|PlayBook|BB10)/i.test(n)?"BlackBerry":/Windows Phone/i.test(n)?"Windows Phone":/Android/.test(n)?"Android":""},referringDomain:function(a){a=a.split("/");return 3<=a.length?a[2]:""},properties:function(){return d.strip_empty_properties({os:d.info.os(),browser:d.info.browser(),device:d.info.device(),mp_lib:"web"})},people_properties:function(){return d.strip_empty_properties({$os:d.info.os(),
$browser:d.info.browser()})},pageviewInfo:function(a){return d.strip_empty_properties({mp_page:a,mp_referrer:l.referrer,mp_browser:d.info.browser(),mp_platform:d.info.os()})}};var x={log:function(){if(t&&!d.isUndefined(m)&&m)try{m.log.apply(m,arguments)}catch(a){d.each(arguments,function(a){m.log(a)})}},error:function(){if(t&&!d.isUndefined(m)&&m){var a=["Mixpanel error:"].concat(d.toArray(arguments));try{m.error.apply(m,a)}catch(b){d.each(a,function(a){m.error(a)})}}},critical:function(){if(!d.isUndefined(m)&&
m){var a=["Mixpanel error:"].concat(d.toArray(arguments));try{m.error.apply(m,a)}catch(b){d.each(a,function(a){m.error(a)})}}}},w=function(){};w.prototype.create_properties=function(){};w.prototype.event_handler=function(){};w.prototype.after_track_handler=function(){};w.prototype.init=function(a){this.mp=a;return this};w.prototype.track=function(a,b,c,f){var e=this,l=d.dom_query(a);if(0==l.length)x.error("The DOM query ("+a+") returned 0 elements");else return d.each(l,function(a){d.register_event(a,
this.override_event,function(a){var g={},d=e.create_properties(c,this),l=e.mp.get_config("track_links_timeout");e.event_handler(a,this,g);window.setTimeout(e.track_callback(f,d,g,!0),l);e.mp.track(b,d,e.track_callback(f,d,g))})},this),!0};w.prototype.track_callback=function(a,d,b,c){c=c||!1;var f=this;return function(){b.callback_fired||(b.callback_fired=!0,a&&!1===a(c,d)||f.after_track_handler(d,b,c))}};w.prototype.create_properties=function(a,b){return"function"===typeof a?a(b):d.extend({},a)};
var G=function(){this.override_event="click"};d.inherit(G,w);G.prototype.create_properties=function(a,d){var b=G.superclass.create_properties.apply(this,arguments);d.href&&(b.url=d.href);return b};G.prototype.event_handler=function(a,d,b){b.new_tab=2===a.which||a.metaKey||"_blank"===d.target;b.href=d.href;b.new_tab||a.preventDefault()};G.prototype.after_track_handler=function(a,d,b){d.new_tab||setTimeout(function(){window.location=d.href},0)};var I=function(){this.override_event="submit"};d.inherit(I,
w);I.prototype.event_handler=function(a,d,b){b.element=d;a.preventDefault()};I.prototype.after_track_handler=function(a,d,b){setTimeout(function(){d.element.submit()},0)};var r=function(a){this.props={};this.campaign_params_saved=!1;this.name=a.cookie_name?"mp_"+a.cookie_name:"mp_"+a.token+"_mixpanel";this.load();this.update_config(a);this.upgrade(a);this.save()};r.prototype.properties=function(){var a={};d.each(this.props,function(b,c){d.include(C,c)||(a[c]=b)});return a};r.prototype.load=function(){if(!this.disabled){var a=
d.cookie.parse(this.name);a&&(this.props=d.extend({},a))}};r.prototype.upgrade=function(a){var b=a.upgrade,c;b&&(c="mp_super_properties","string"===typeof b&&(c=b),b=d.cookie.parse(c),d.cookie.remove(c),d.cookie.remove(c,!0),b&&(this.props=d.extend(this.props,b.all,b.events)));if(!a.cookie_name&&"mixpanel"!==a.name&&(c="mp_"+a.token+"_"+a.name,b=d.cookie.parse(c)))d.cookie.remove(c),d.cookie.remove(c,!0),this.register_once(b)};r.prototype.save=function(){this.disabled||d.cookie.set(this.name,d.JSONEncode(this.props),
this.expire_days,this.cross_subdomain)};r.prototype.remove=function(){d.cookie.remove(this.name,!1);d.cookie.remove(this.name,!0)};r.prototype.clear=function(){this.remove();this.props={}};r.prototype.register_once=function(a,b,c){return d.isObject(a)?("undefined"===typeof b&&(b="None"),this.expire_days="undefined"===typeof c?this.default_expiry:c,d.each(a,function(a,g){if(!this.props[g]||this.props[g]===b)this.props[g]=a},this),this.save(),!0):!1};r.prototype.register=function(a,b){return d.isObject(a)?
(this.expire_days="undefined"===typeof b?this.default_expiry:b,d.extend(this.props,a),this.save(),!0):!1};r.prototype.unregister=function(a){a in this.props&&(delete this.props[a],this.save())};r.prototype.update_campaign_params=function(){this.campaign_params_saved||(this.register_once(d.info.campaignParams()),this.campaign_params_saved=!0)};r.prototype.update_search_keyword=function(a){this.register(d.info.searchInfo(a))};r.prototype.update_referrer_info=function(a){this.register_once({$initial_referrer:a||
"$direct",$initial_referring_domain:d.info.referringDomain(a)||"$direct"},"")};r.prototype.get_referrer_info=function(){return d.strip_empty_properties({$initial_referrer:this.props.$initial_referrer,$initial_referring_domain:this.props.$initial_referring_domain})};r.prototype.safe_merge=function(a){d.each(this.props,function(d,b){b in a||(a[b]=d)});return a};r.prototype.update_config=function(a){this.default_expiry=this.expire_days=a.cookie_expiration;this.set_disabled(a.disable_cookie);this.set_cross_subdomain(a.cross_subdomain_cookie)};
r.prototype.set_disabled=function(a){(this.disabled=a)&&this.remove()};r.prototype.set_cross_subdomain=function(a){a!==this.cross_subdomain&&(this.cross_subdomain=a,this.remove(),this.save())};r.prototype.get_cross_subdomain=function(){return this.cross_subdomain};r.prototype._add_to_people_queue=function(a,b){var c=this._get_queue_key(a),f=b[a],e=this._get_or_create_queue("$set"),l=this._get_or_create_queue("$add"),h=this._get_or_create_queue("$append",[]);"__mps"===c?(d.extend(e,f),this._pop_from_people_queue("$add",
f)):"__mpa"===c?d.each(f,function(a,g){g in e?e[g]+=a:(g in l||(l[g]=0),l[g]+=a)},this):"__mpap"===c&&h.push(f);x.log("MIXPANEL PEOPLE REQUEST (QUEUED, PENDING IDENTIFY):");x.log(b);this.save()};r.prototype._pop_from_people_queue=function(a,b){var c=this._get_queue(a);d.isUndefined(c)||(d.each(b,function(a,g){delete c[g]},this),this.save())};r.prototype._get_queue_key=function(a){if("$set"===a)return"__mps";if("$add"===a)return"__mpa";if("$append"===a)return"__mpap";x.error("Invalid queue:",a)};r.prototype._get_queue=
function(a){return this.props[this._get_queue_key(a)]};r.prototype._get_or_create_queue=function(a,b){var c=this._get_queue_key(a);b=d.isUndefined(b)?{}:b;return this.props[c]||(this.props[c]=b)};var J=function(g,b,c){var f,e="triggermail.lytics"===c?a:a[c];if(e&&!d.isArray(e))x.error("You have already initialized "+c);else return f=new k,f._init(g,b,c),f.people=new v,f.people._init(f),t=t||f.get_config("debug"),d.isUndefined(e)||(f._execute_array.call(f.people,e.people),f._execute_array(e)),f},k=
function(){};k.prototype.init=function(g,b,d){if("undefined"===typeof d)x.error("You must name your new library: init(token, config, name)");else if("triggermail.lytics"===d)x.error("You must initialize the main mixpanel object right after you include the Mixpanel js snippet");else return g=J(g,b,d),a[d]=g,g._loaded(),g};k.prototype._init=function(a,b,c){this.__loaded=!0;this.config={};this.set_config(d.extend({},N,b,{name:c,token:a,callback_fn:("triggermail.lytics"===c?c:"triggermail.lytics."+c)+
"._jsc"}));this._jsc=function(){};this.__dom_loaded_queue=[];this.__request_queue=[];this.__disabled_events=[];this._flags={disable_all_events:!1,identify_called:!1};this.cookie=new r(this.config);this.register_once({distinct_id:d.UUID()},"")};k.prototype._loaded=function(){this.get_config("loaded")(this);this.get_config("track_pageview")&&this.track_pageview()};k.prototype._dom_loaded=function(){d.each(this.__dom_loaded_queue,function(a){this._track_dom.apply(this,a)},this);d.each(this.__request_queue,
function(a){this._send_request.apply(this,a)},this);delete this.__dom_loaded_queue;delete this.__request_queue};k.prototype._track_dom=function(a,d){if(this.get_config("img"))return x.error("You can't use DOM tracking functions with img = true."),!1;if(!L)return this.__dom_loaded_queue.push([a,d]),!1;var b=(new a).init(this);return b.track.apply(b,d)};k.prototype._prepare_callback=function(a,b){if(d.isUndefined(a))return null;if(B)return function(d){a(d,b)};var c=this._jsc,f=""+Math.floor(1E8*Math.random()),
e=this.get_config("callback_fn")+'["'+f+'"]';c[f]=function(d){delete c[f];a(d,b)};return e};k.prototype._send_request=function(a,b,c){if(y)this.__request_queue.push(arguments);else{var f=this.get_config("verbose");this.get_config("test")&&(b.test=1);f&&(b.verbose=1);this.get_config("img")&&(b.img=1);c&&!B&&(b.callback=c);b.ip=this.get_config("ip")?1:0;b._=(new Date).getTime().toString();if("img"in b){var e=l.createElement("img");e.src=a;l.body.appendChild(e)}else if(B){var h=new XMLHttpRequest;h.open("POST",
a,!0);h.setRequestHeader("Content-Type","application/x-www-form-urlencoded");h.withCredentials=!0;h.onreadystatechange=function(a){4===h.readyState&&(200===h.status?c&&(f?c(d.JSONDecode(h.responseText)):c(Number(h.responseText))):(a="Bad HTTP status: "+h.status+" "+h.statusText,x.error(a),c&&(f?c({status:0,error:a}):c(0))))};h.send(d.HTTPBuildQuery(b))}else{a+="?"+d.HTTPBuildQuery(b);e=l.createElement("script");e.type="text/javascript";e.async=!0;e.defer=!0;e.src=a;var k=l.getElementsByTagName("script")[0];
k.parentNode.insertBefore(e,k)}}};k.prototype._execute_array=function(a){var b,c=[],f=[],e=[];d.each(a,function(a){a&&(b=a[0],"function"===typeof a?a.call(this):d.isArray(a)&&"alias"===b?c.push(a):d.isArray(a)&&-1!=b.indexOf("track")&&"function"===typeof this[b]?e.push(a):f.push(a))},this);a=function(a,b){d.each(a,function(a){this[a[0]].apply(this,a.slice(1))},b)};a(c,this);a(f,this);a(e,this)};k.prototype.push=function(a){this._execute_array([a])};k.prototype.disable=function(a){"undefined"===typeof a?
this._flags.disable_all_events=!0:this.__disabled_events=this.__disabled_events.concat(a)};k.prototype.track=function(a,b,c){if("undefined"===typeof a)x.error("No event name provided to mixpanel.track");else{b=b||{};b.token=b.token||this.get_config("token");this.cookie.update_search_keyword(l.referrer);this.get_config("store_google")&&this.cookie.update_campaign_params();this.get_config("save_referrer")&&this.cookie.update_referrer_info(l.referrer);b=d.extend({},d.info.properties(),this.cookie.properties(),
b);delete b.ch;b={event:a,properties:b};t&&(b.validate=1);b=d.truncate(b,1023);var f=d.JSONEncode(b),f=d.base64Encode(f);x.log("MIXPANEL REQUEST:");x.log(b);payload={data:f};-1!=this.get_distinct_id().indexOf("live_demo")?(payload.live_demo=!0,track_path=this.get_config("api_host")+"/templates/demo_track/"+a):-1!=this.get_distinct_id().indexOf("event_stream")?(payload.event_stream=!0,track_path=this.get_config("api_host")+"/templates/event_stream_track/"+a):track_path=this.get_config("api_host")+
"/track/"+a;this._send_request(track_path,payload,this._prepare_callback(c,b));return b}};k.prototype.track_pageview=function(a){"undefined"===typeof a&&(a=l.location.href);this.track("mp_page_view",d.info.pageviewInfo(a))};k.prototype.track_links=function(){return this._track_dom.call(this,G,arguments)};k.prototype.track_forms=function(){return this._track_dom.call(this,I,arguments)};k.prototype.register=function(a,b){this.cookie.register(a,b)};k.prototype.register_once=function(a,b,d){this.cookie.register_once(a,
b,d)};k.prototype.unregister=function(a){this.cookie.unregister(a)};k.prototype._register_single=function(a,b){var d={};d[a]=b;this.register(d)};k.prototype.identify=function(a,b,d,c){a!=this.get_distinct_id()&&a!=this.get_property("__alias")&&(this.unregister("__alias"),this._register_single("distinct_id",a));this._flags.identify_called=!0;this.people._flush(b,d,c)};k.prototype.get_distinct_id=function(){return this.get_property("distinct_id")};k.prototype.alias=function(a,b){if(a===this.get_property("$people_distinct_id"))return x.critical("Attempting to create alias for existing People user - aborting."),
-2;var c=this;d.isUndefined(b)&&(b=this.get_distinct_id());if(a!==b)return this._register_single("__alias",a),this.track("$create_alias",{alias:a,distinct_id:b},function(b){c.identify(a)});x.error("alias matches current distinct_id - skipping api call.");this.identify(a);return-1};k.prototype.name_tag=function(a){this._register_single("mp_name_tag",a)};k.prototype.set_config=function(a){d.isObject(a)&&(d.extend(this.config,a),this.cookie&&this.cookie.update_config(this.config),t=t||this.get_config("debug"))};
k.prototype.get_config=function(a){return this.config[a]};k.prototype.get_property=function(a){return this.cookie.props[a]};k.prototype.toString=function(){var a=this.get_config("name");"triggermail.lytics"!==a&&(a="triggermail.lytics."+a);return a};var v=function(){};v.prototype._init=function(a){this._mixpanel=a};v.prototype.set=function(a,b,c){var f={},e={};d.isObject(a)?(d.each(a,function(a,b){"$distinct_id"==b||"$token"==b||(e[b]=a)}),c=b):e[a]=b;this._get_config("save_referrer")&&this._mixpanel.cookie.update_referrer_info(l.referrer);
e=d.extend({},d.info.people_properties(),this._mixpanel.cookie.get_referrer_info(),e);f.$set=e;return this._send_request(f,c)};v.prototype.increment=function(a,b,c){var f={},e={};d.isObject(a)?(d.each(a,function(a,b){"$distinct_id"==b||"$token"==b||(isNaN(parseFloat(a))?x.error("Invalid increment value passed to mixpanel.people.increment - must be a number"):e[b]=a)}),c=b):(d.isUndefined(b)&&(b=1),e[a]=b);f.$add=e;return this._send_request(f,c)};v.prototype.append=function(a,b,c){var f={},e={};d.isObject(a)?
(d.each(a,function(a,b){"$distinct_id"==b||"$token"==b||(e[b]=a)}),c=b):e[a]=b;f.$append=e;return this._send_request(f,c)};v.prototype.track_charge=function(a,b,c){if(!d.isNumber(a)&&(a=parseFloat(a),isNaN(a))){x.error("Invalid value passed to mixpanel.people.track_charge - must be a number");return}return this.append("$transactions",d.extend({$amount:a},b),c)};v.prototype.clear_charges=function(a){return this.set("$transactions",[],a)};v.prototype.delete_user=function(){if(this._identify_called()){var a=
{$delete:this._mixpanel.get_distinct_id()};return this._send_request(a)}x.error("mixpanel.people.delete_user() requires you to call identify() first")};v.prototype.toString=function(){return this._mixpanel.toString()+".people"};v.prototype._send_request=function(a,b){a.$token=this._get_config("token");a.$distinct_id=this._mixpanel.get_distinct_id();var c=d.encodeDates(a),f=d.truncate(c,255),c=d.JSONEncode(c),c=d.base64Encode(c);if(!this._identify_called())return this._enqueue(a),d.isUndefined(b)||
(this._get_config("verbose")?b({status:-1,error:null}):b(-1)),f;x.log("MIXPANEL PEOPLE REQUEST:");x.log(f);this._mixpanel._send_request(this._get_config("api_host")+"/engage/",{data:c},this._mixpanel._prepare_callback(b,f));return f};v.prototype._get_config=function(a){return this._mixpanel.get_config(a)};v.prototype._identify_called=function(){return!0===this._mixpanel._flags.identify_called};v.prototype._enqueue=function(a){"$set"in a?this._mixpanel.cookie._add_to_people_queue("$set",a):"$add"in
a?this._mixpanel.cookie._add_to_people_queue("$add",a):"$append"in a?this._mixpanel.cookie._add_to_people_queue("$append",a):x.error("Invalid call to _enqueue():",a)};v.prototype._flush=function(a,b,c){var f=this,e=d.extend({},this._mixpanel.cookie._get_queue("$set")),h=d.extend({},this._mixpanel.cookie._get_queue("$add")),l=this._mixpanel.cookie._get_queue("$append");!d.isUndefined(e)&&(d.isObject(e)&&!d.isEmptyObject(e))&&(f._mixpanel.cookie._pop_from_people_queue("$set",e),this.set(e,function(b,
c){0==b&&f._mixpanel.cookie._add_to_people_queue("$set",e);d.isUndefined(a)||a(b,c)}));!d.isUndefined(h)&&(d.isObject(h)&&!d.isEmptyObject(h))&&(f._mixpanel.cookie._pop_from_people_queue("$add",h),this.increment(h,function(a,c){0==a&&f._mixpanel.cookie._add_to_people_queue("$add",h);d.isUndefined(b)||b(a,c)}));if(!d.isUndefined(l)&&d.isArray(l)&&l.length)for(var k=l.length-1;0<=k;k--){var t=l.pop();f.append(t,function(a,b){0==a&&f._mixpanel.cookie._add_to_people_queue("$append",t);d.isUndefined(c)||
c(a,b)})}};d.toArray=d.toArray;d.isObject=d.isObject;d.JSONEncode=d.JSONEncode;d.JSONDecode=d.JSONDecode;d.isEmptyObject=d.isEmptyObject;k.prototype.init=k.prototype.init;k.prototype.disable=k.prototype.disable;k.prototype.track=k.prototype.track;k.prototype.track_links=k.prototype.track_links;k.prototype.track_forms=k.prototype.track_forms;k.prototype.track_pageview=k.prototype.track_pageview;k.prototype.register=k.prototype.register;k.prototype.register_once=k.prototype.register_once;k.prototype.unregister=
k.prototype.unregister;k.prototype.identify=k.prototype.identify;k.prototype.alias=k.prototype.alias;k.prototype.name_tag=k.prototype.name_tag;k.prototype.set_config=k.prototype.set_config;k.prototype.get_config=k.prototype.get_config;k.prototype.get_property=k.prototype.get_property;k.prototype.get_distinct_id=k.prototype.get_distinct_id;k.prototype.toString=k.prototype.toString;r.prototype.properties=r.prototype.properties;r.prototype.update_search_keyword=r.prototype.update_search_keyword;r.prototype.update_referrer_info=
r.prototype.update_referrer_info;r.prototype.get_cross_subdomain=r.prototype.get_cross_subdomain;r.prototype.clear=r.prototype.clear;v.prototype.set=v.prototype.set;v.prototype.increment=v.prototype.increment;v.prototype.append=v.prototype.append;v.prototype.track_charge=v.prototype.track_charge;v.prototype.clear_charges=v.prototype.clear_charges;v.prototype.delete_user=v.prototype.delete_user;v.prototype.toString=v.prototype.toString;if(d.isUndefined(a))x.critical("'mixpanel' object not initialized. Ensure you are using the latest version of the Mixpanel JS Library along with the snippet we provide.");
else if(a.__loaded||a.config&&a.cookie)x.error("Mixpanel library has already been downloaded at least once.");else if(1.1>e)x.critical("Version mismatch; please ensure you're using the latest version of the Mixpanel code snippet.");else{var E={};d.each(a._i,function(a){var b;a&&d.isArray(a)&&(b=a[a.length-1],a=J.apply(this,a),E[b]=a)});var D=function(){d.each(E,function(b,c){"triggermail.lytics"!==c&&(a[c]=b)});a._=d};a.init=function(b,c,d){d?a[d]||(a[d]=E[d]=J(b,c,d),a[d]._loaded()):(d=a,E["triggermail.lytics"]?
d=E["triggermail.lytics"]:b&&(d=J(b,c,"triggermail.lytics")),window["triggermail.lytics"]=a=d,D())};a.init();d.each(E,function(a){a._loaded()});if(l.addEventListener)"complete"==l.readyState?b():l.addEventListener("DOMContentLoaded",b,!1);else if(l.attachEvent){l.attachEvent("onreadystatechange",b);e=!1;try{e=null==window.frameElement}catch(F){}if(l.documentElement.doScroll&&e){var M=function(){try{l.documentElement.doScroll("left")}catch(a){setTimeout(M,1);return}b()};M()}}d.register_event(window,
"load",b,!0)}})(window.triggermail.lytics);var D=function(){var a={el:function(b,e){var f=document.createElement(b),h;if((e=a.merge({},e))&&e.style)a.applyCSS(f,e.style),delete e.style;for(h in e)e.hasOwnProperty(h)&&(f[h]=e[h]);return f},applyCSS:function(a,b){for(var f in b)if(b.hasOwnProperty(f))try{a.style[f]=b[f]}catch(h){}},txt:function(a){return document.createTextNode(a)},row:function(b,e,f){f=f||"td";var h=a.count(b,null)+1,p=a.el("tr"),m,u={style:a.getStyles(f,e),colSpan:h,onmouseover:function(){a.forEach(this.parentNode.childNodes,
function(b){"td"===b.nodeName.toLowerCase()&&a.applyCSS(b,a.getStyles("td_hover",e))})},onmouseout:function(){a.forEach(this.parentNode.childNodes,function(b){"td"===b.nodeName.toLowerCase()&&a.applyCSS(b,a.getStyles("td",e))})}};a.forEach(b,function(b){null!==b&&(m=a.el(f,u),b.nodeType?m.appendChild(b):m.innerHTML=a.shorten(b.toString()),p.appendChild(m))});return p},hRow:function(b,e){return a.row(b,e,"th")},table:function(b,e){b=b||[];var f={style:a.getStyles("thead",e)},h={style:a.getStyles("tbody",
e)},p={style:a.getStyles("table",e)},p=a.el("table",p),f=a.el("thead",f),h=a.el("tbody",h);b.length&&(p.appendChild(f),f.appendChild(a.hRow(b,e)));p.appendChild(h);return{node:p,tbody:h,thead:f,appendChild:function(a){this.tbody.appendChild(a)},addRow:function(b,c,f){this.appendChild(a.row.call(a,b,c||e,f));return this}}},shorten:function(a){a=a.replace(/^\s\s*|\s\s*$|\n/g,"");return 40<a.length?a.substring(0,39)+"...":a},htmlentities:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,
"&gt;")},merge:function(b,e){"object"!==typeof b&&(b={});for(var f in e)if(e.hasOwnProperty(f)){var h=e[f];b[f]="object"===typeof h?a.merge(b[f],h):h}f=2;for(h=arguments.length;f<h;f++)a.merge(b,arguments[f]);return b},count:function(a,b){for(var f=0,h=0,p=a.length;h<p;h++)a[h]===b&&f++;return f},thead:function(a){return a.getElementsByTagName("thead")[0]},forEach:function(a,b,f){f||(f=b);b=a.length;for(var h=-1;++h<b&&!1!==f(a[h],h,a););return!0},type:function(a){try{if(null===a)return"null";if(void 0===
a)return"undefined";var b=Object.prototype.toString.call(a).match(/\s(.+?)\]/)[1].toLowerCase();return a.nodeType?1===a.nodeType?"domelement":"domnode":/^(string|number|array|regexp|function|date|boolean)$/.test(b)?b:"object"===typeof a?a.jquery&&"string"===typeof a.jquery?"jquery":"object":a===window||a===document?"object":"default"}catch(f){return"default"}},within:function(a){return{is:function(b){for(var f in a)if(a[f]===b)return f;return""}}},common:{circRef:function(c,e,f){return a.expander("[POINTS BACK TO <strong>"+
e+"</strong>]","Click to show this item anyway",function(){this.parentNode.appendChild(b(c,{maxDepth:1}))})},depthReached:function(c,e){return a.expander("[DEPTH REACHED]","Click to show this item anyway",function(){try{this.parentNode.appendChild(b(c,{maxDepth:1}))}catch(f){this.parentNode.appendChild(a.table(["ERROR OCCURED DURING OBJECT RETRIEVAL"],"error").addRow([f.message]).node)}})}},getStyles:function(c,e){e=b.settings.styles[e]||{};return a.merge({},b.settings.styles["default"][c],e[c])},
expander:function(b,e,f){return a.el("a",{innerHTML:a.shorten(b)+' <b style="visibility:hidden;">[+]</b>',title:e,onmouseover:function(){this.getElementsByTagName("b")[0].style.visibility="visible"},onmouseout:function(){this.getElementsByTagName("b")[0].style.visibility="hidden"},onclick:function(){this.style.display="none";f.call(this);return!1},style:{cursor:"pointer"}})},stringify:function(b){var e=a.type(b),f,h=!0;if("array"===e)return f="[",a.forEach(b,function(b,c){f+=(0===c?"":", ")+a.stringify(b)}),
f+"]";if("object"===typeof b){f="{";for(var p in b)b.hasOwnProperty(p)&&(f+=(h?"":", ")+p+":"+a.stringify(b[p]),h=!1);return f+"}"}return"regexp"===e?"/"+b.source+"/":"string"===e?'"'+b.replace(/"/g,'\\"')+'"':b.toString()},headerGradient:function(){var a=document.createElement("canvas");if(!a.getContext)return"";var b=a.getContext("2d");a.height=30;a.width=1;var f=b.createLinearGradient(0,0,0,30);f.addColorStop(0,"rgba(0,0,0,0)");f.addColorStop(1,"rgba(0,0,0,0.25)");b.fillStyle=f;b.fillRect(0,0,
1,30);return"url("+(a.toDataURL&&a.toDataURL()||"")+")"}()},b=function(c,e){e=e||{};var f=a.merge({},b.config,e),h=a.el("div"),p={},m=!1;b.settings=f;var u={string:function(b){return a.txt('"'+a.shorten(b.replace(/"/g,'\\"'))+'"')},number:function(b){return a.txt(b)},regexp:function(b){var c=a.table(["RegExp",null],"regexp"),e=a.table(),h=a.expander("/"+b.source+"/","Click to show more",function(){this.parentNode.appendChild(c.node)});e.addRow(["g",b.global]).addRow(["i",b.ignoreCase]).addRow(["m",
b.multiline]);c.addRow(["source","/"+b.source+"/"]).addRow(["flags",e.node]).addRow(["lastIndex",b.lastIndex]);return f.expanded?c.node:h},domelement:function(b,c){var e=a.table(["DOMElement",null],"domelement"),h=b.nodeName||"";e.addRow(["tag","&lt;"+h.toLowerCase()+"&gt;"]);a.forEach(["id","className","innerHTML","src","href"],function(c){b[c]&&e.addRow([c,a.htmlentities(b[c])])});return f.expanded?e.node:a.expander("DOMElement ("+h.toLowerCase()+")","Click to show more",function(){this.parentNode.appendChild(e.node)})},
domnode:function(b){var c=a.table(["DOMNode",null],"domelement"),e=a.htmlentities((b.data||"UNDEFINED").replace(/\n/g,"\\n"));c.addRow(["nodeType",b.nodeType+" ("+b.nodeName+")"]).addRow(["data",e]);return f.expanded?c.node:a.expander("DOMNode","Click to show more",function(){this.parentNode.appendChild(c.node)})},jquery:function(a,b,c){return u.array(a,b,c,!0)},object:function(b,c,e){var h=a.within(p).is(b);if(h)return a.common.circRef(b,h,f);p[e||"TOP"]=b;if(c===f.maxDepth)return a.common.depthReached(b,
f);var q=a.table(["Object",null],"object");e=!0;for(var z in b)if(!b.hasOwnProperty||b.hasOwnProperty(z)){var h=b[z],B=a.type(h);e=!1;try{q.addRow([z,u[B](h,c+1,z)],B)}catch(y){window.console&&window.console.log&&console.log(y.message)}}e?q.addRow(["<small>[empty]</small>"]):q.thead.appendChild(a.hRow(["key","value"],"colHeader"));b=f.expanded||m?q.node:a.expander(a.stringify(b),"Click to show more",function(){this.parentNode.appendChild(q.node)});m=!0;return b},array:function(b,c,e,h){var m=a.within(p).is(b);
if(m)return a.common.circRef(b,m);p[e||"TOP"]=b;if(c===f.maxDepth)return a.common.depthReached(b);e=h?"jQuery":"Array";var z=a.table([e+"("+b.length+")",null],h?"jquery":e.toLowerCase()),B=!0,y=0;h&&z.addRow(["selector",b.selector]);a.forEach(b,function(d,e){if(0<=f.maxArray&&++y>f.maxArray)return z.addRow([e+".."+(b.length-1),u[a.type(d)]("...",c+1,e)]),!1;B=!1;z.addRow([e,u[a.type(d)](d,c+1,e)])});h||(B?z.addRow(["<small>[empty]</small>"]):z.thead.appendChild(a.hRow(["index","value"],"colHeader")));
return f.expanded?z.node:a.expander(a.stringify(b),"Click to show more",function(){this.parentNode.appendChild(z.node)})},"function":function(b,c,e){if(c=a.within(p).is(b))return a.common.circRef(b,c);p[e||"TOP"]=b;var h=a.table(["Function",null],"function");a.table(["Arguments"]);e=b.toString().match(/\((.+?)\)/);b=b.toString().match(/\(.*?\)\s+?\{?([\S\s]+)/)[1].replace(/\}?$/,"");h.addRow(["arguments",e?e[1].replace(/[^\w_,\s]/g,""):"<small>[none/native]</small>"]).addRow(["body",b]);return f.expanded?
h.node:a.expander("function(){...}","Click to see more about this function.",function(){this.parentNode.appendChild(h.node)})},date:function(b){var c=a.table(["Date",null],"date"),e=b.toString().split(/\s/);c.addRow(["Time",e[4]]).addRow(["Date",e.slice(0,4).join("-")]);return f.expanded?c.node:a.expander("Date (timestamp): "+ +b,"Click to see a little more info about this date",function(){this.parentNode.appendChild(c.node)})},"boolean":function(b){return a.txt(b.toString().toUpperCase())},undefined:function(){return a.txt("UNDEFINED")},
"null":function(){return a.txt("NULL")},"default":function(){return a.txt("prettyPrint: TypeNotFound Error")}};h.appendChild(u[f.forceObject?"object":a.type(c)](c,0));return h};b.config={expanded:!0,forceObject:!1,maxDepth:3,maxArray:-1,styles:{array:{th:{backgroundColor:"#6DBD2A",color:"white"}},"function":{th:{backgroundColor:"#D82525"}},regexp:{th:{backgroundColor:"#E2F3FB",color:"#000"}},object:{th:{backgroundColor:"#1F96CF"}},jquery:{th:{backgroundColor:"#FBF315"}},error:{th:{backgroundColor:"red",
color:"yellow"}},domelement:{th:{backgroundColor:"#F3801E"}},date:{th:{backgroundColor:"#A725D8"}},colHeader:{th:{backgroundColor:"#EEE",color:"#000",textTransform:"uppercase"}},"default":{table:{borderCollapse:"collapse",width:"100%"},td:{padding:"5px",fontSize:"12px",backgroundColor:"#FFF",color:"#222",border:"1px solid #000",verticalAlign:"top",fontFamily:'"Consolas","Lucida Console",Courier,mono',whiteSpace:"nowrap"},td_hover:{},th:{padding:"5px",fontSize:"12px",backgroundColor:"#222",color:"#EEE",
textAlign:"left",border:"1px solid #000",verticalAlign:"top",fontFamily:'"Consolas","Lucida Console",Courier,mono',backgroundImage:a.headerGradient,backgroundRepeat:"repeat-x"}}}};return b}();jQuery.extend(triggermail,function(){var a=function(a,c){var e=a.obem;"undefined"!=typeof e&&""!=e&&"undefined"==typeof triggermail.lytics.get_property("obem")&&(triggermail.lytics.register({OBFUSCATED_EMAIL_PROPERTY:e},365),triggermail.track("identify",{customer:a}));e=a.email;if(!(void 0==e||""==e)){if(!0!==
c&&(e=triggermail.core.sanitizer.sanitize("email",e),!e))return;var f=triggermail.lytics.get_property("email");if(!(triggermail.util.isValidEmail(f)&&f!=e))return e!=triggermail.lytics.get_property("email")&&(triggermail.lytics.register({email:e},365),triggermail.track("identify",{customer:a})),a}};return{track:function(a,c){var e=jQuery.extend({},c);jQuery.extend(c,triggermail.lytics.cookie.props);try{c.url=window.location.href,-1<c.url.indexOf("s.thebrighttag")&&delete c.url}catch(f){}-1<c.url.indexOf("/eton/")&&
(c.distinct_id=ETON_DISTINCT_ID);if(("unsubscribe"==a||"optin"==a)&&e.email)c.email=e.email;"page_view"!=a&&("true"==triggermail.util.cookie.get("tm_debug")?triggermail.lytics.track(a,c,this.track_callback(a,c)):triggermail.lytics.track(a,c));triggermail.lytics.get_distinct_id()&&(c.distinct_id=triggermail.lytics.get_distinct_id());try{!0===triggermail.integ.debug&&console.debug(a,c)}catch(h){}},report_to_insanetiego:function(a,c){if("true"===triggermail.util.cookie.get("tm_debug")){0===$("#insanetiego").length&&
triggermail.insanetiego.inject_div();var e=D(c,{styles:{array:{th:{display:"none"}},object:{th:{display:"none"}},"default":{th:{display:"none"}}}});$("#insanetiego").append("<p><b>Event: "+a+"</b></p>");$("#insanetiego").append(e);$.each(c.products,function(a,b){var c,e;b.image&&$("<img/>").attr("src",b.image).load(function(){c=this.width;e=this.height;$("#insanetiego").append("<p><b>Image size: width-"+c+" height-"+e+"<b></p>");$("#insanetiego").append('<img src="'+b.image+'" height="100" width="100" />')});
b.alternative_image&&(c=this.width,e=this.height,$("<img/>").attr("src",b.alternative_image).load(function(){c=this.width;e=this.height;$("#insanetiego").append("<p><b>Alternative Image size: width-"+c+" height-"+e+"<b></p>");$("#insanetiego").append('<img src="'+b.alternative_image+'" height="100" width="100"/>')}))})}},validate:function(a){"true"===triggermail.util.cookie.get("tm_debug")&&(a?$("#insanetiego").append('<p><b style="color:#64E813;">Event is ok</b></p>'):$("#insanetiego").append('<p><b style="color:#E60508;">The Event Seems Broken</b></p>'))},
track_callback:function(a,c){return function(e){triggermail.report_to_insanetiego(a,c);triggermail.validate(e)}},add_to_cart:function(a){return this.track("add_to_cart",{products:[a]})},remove_from_cart:function(a){return this.track("remove_from_cart",{products:[a]})},wishlist:function(a){return this.track("wishlist",{products:[a]})},view_cart:function(a){return this.track("viewed_cart",a)},stop:function(a){return this.track("stop",a)},page:function(a){return this.track("page_view",a)},purchase:function(a){return this.track("purchase",
a)},checkout_start:function(a){return this.track("checkout_start",a)},view:function(a,c){triggermail.integ.salt_products&&(a.salt=Math.random().toString(36).replace(".",""));var e=jQuery.extend(c||{},{products:[a]});return this.track("viewed_product",e)},view_content:function(a,c){triggermail.integ.salt_products&&(a.salt=Math.random().toString(36).replace(".",""));var e=jQuery.extend(c||{},{contents:[a]});return this.track("viewed_content",e)},search:function(a){return this.track("search",a)},identify:function(b,
c){return a(b,c)},subscribe:function(b){b.source="newsletter";return a(b)},unsubscribe:function(a){return this.track("unsubscribe",a)},optin:function(a){return this.track("optin",a)},patch:function(a){return this.track("patch",a)},merge:function(a){return this.track("merge",a)},eton_show:function(a){return this.track("eton_show",a)},init:function(a){},exception:function(a){var c={};jQuery.extend(c,triggermail.lytics._.info.properties());try{c.url=window.location.href,-1<c.url.indexOf("s.thebrighttag")&&
delete c.url,c.message=a.message}catch(e){}c.error=a;this.track("exception",c)},EMAIL_ADDRESS_PROPERTY:"email_address",PAGE_VIEW:"page_view",MAX_PROPERTY_LENGTH:1024}}());triggermail.util=function(){return{price:function(a){return isNaN(parseFloat(a))?parseFloat(a.replace(/[^0-9\.]/g,"")):parseFloat(a)},unique:function(a){for(var b={},c=0;c<a.length;c++)b[a[c]]=!0;return jQuery.map(b,function(a,b){return b})},slugify:function(a){return a.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")},serializeForm:function(a){var b=
{};a=a.serializeArray();$.each(a,function(){void 0!==b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||"")):b[this.name]=this.value||""});return b},getUrlParam:function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=RegExp("[\\?&]"+a+"=([^&#]*)").exec(window.location.search);return null==a?"":decodeURIComponent(a[1].replace(/\+/g," "))},isMobile:function(){var a=!1,b="iphone;ipad;android;blackberry;nokia;opera mini;windows mobile;windows phone;iemobile".split(";"),
c;for(c in b)0<navigator.userAgent.toLowerCase().indexOf(b[c].toLowerCase())&&(a=!0);return a},getParamFromQueryString:function(a,b){return decodeURI((RegExp(b+"=(.+?)(&|$)").exec(a)||[,null])[1])},trimString:function(a,b){return jQuery.trim(a).substring(0,b)},isAnonymousUser:function(){var a=triggermail.lytics.get_property(triggermail.core.EMAIL_ADDRESS_PROPERTY);return!this.isValidEmail(a)},emRegex:/\S+@\S+\.\S+/,isValidEmail:function(a){return triggermail.util.emRegex.test(a)},findEmail:function(a,
b){try{return"undefined"==typeof b&&(b=triggermail.util.emRegex),b.exec(a).pop()}catch(c){}},hashCode:function(a){var b=0,c,e;if(0==a.length)return b;for(c=0;c<a.length;c++)e=a.charCodeAt(c),b=(b<<5)-b+e,b&=b;return b},productHash:function(a){a=this.sanitizeProductName(a[TriggerMail.PRODUCT_NAME_PROPERTY]);return this.hashCode(a)},_getbyte64:function(a,b){_ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var c=_ALPHA.indexOf(a.charAt(b));if(-1===c)throw"Cannot decode base64";
return c},b64decode:function(a){var b=0,c,e,f=a.length,h=[];a=String(a);if(0===f)return a;if(0!==f%4)throw"Cannot decode base64";"="===a.charAt(f-1)&&(b=1,"="===a.charAt(f-2)&&(b=2),f-=4);for(c=0;c<f;c+=4)e=this._getbyte64(a,c)<<18|this._getbyte64(a,c+1)<<12|this._getbyte64(a,c+2)<<6|this._getbyte64(a,c+3),h.push(String.fromCharCode(e>>16,e>>8&255,e&255));switch(b){case 1:e=this._getbyte64(a,c)<<18|this._getbyte64(a,c+1)<<12|this._getbyte64(a,c+2)<<6;h.push(String.fromCharCode(e>>16,e>>8&255));break;
case 2:e=this._getbyte64(a,c)<<18|this._getbyte64(a,c+1)<<12,h.push(String.fromCharCode(e>>16))}return h.join("")},wrapEvent:function(a){var b=Array.prototype.slice.call(arguments,1);return function(){try{return a.apply(this,b.concat(Array.prototype.slice.call(arguments,0)))}catch(c){triggermail.exception(c)}}},removeURLParam:function(a,b){return triggermail.util.updateURLParams(a,b,!1)},keepURLParam:function(a,b){return triggermail.util.updateURLParams(a,b,!0)},updateURLParams:function(a,b,c){var e=
a.split("?")[0],f=[],f=-1!==a.indexOf("?")?a.split("?")[1]:"";if(""!==f){for(var f=f.split("&"),h=f.length-1;0<=h;h-=1)a=f[h].split("=")[0],c?jQuery.isArray(b)?-1==b.indexOf(a)&&f.splice(h,1):a!=b&&f.splice(h,1):jQuery.isArray(b)?-1<b.indexOf(a)&&f.splice(h,1):a==b&&f.splice(h,1);e+=0<f.length?"?"+f.join("&"):""}return e},getArrayElementFromQueryString:function(a,b){var c=[];a||(a=location.href);b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");for(var e=RegExp(b+"=([^&#]+)","ig");;){var f=e.exec(a);
if(f&&f[1])c.push(f[1]);else break}return c.length?1==c.length?c[0]:c:null}}}();triggermail.util.cookie=triggermail.lytics._.cookie;triggermail.util.encode=triggermail.lytics._.JSONEncode;triggermail.util.decode=triggermail.lytics._.JSONDecode;triggermail.demo=function(){var a=triggermail.lytics.get_distinct_id();-1==a.indexOf("live_demo")&&(triggermail.lytics._register_single("distinct_id","live_demo_"+a),a=triggermail.lytics.get_distinct_id());triggermail.lytics.cookie.update_config({live_demo:!0,
cookie_expiration:1});window.open("http://www.bluecore.com/api/templates/live_demo/"+triggermail.Partner.keys.lytics.p+"/"+a)};triggermail.event_stream=function(){var a=triggermail.lytics.get_distinct_id();-1==a.indexOf("event_stream")&&(triggermail.lytics._register_single("distinct_id","event_stream_"+a),a=triggermail.lytics.get_distinct_id());triggermail.lytics.cookie.update_config({event_stream:!0,cookie_expiration:1});window.open("http://www.bluecore.com/api/templates/event_stream/"+triggermail.Partner.keys.lytics.p+
"/"+a)};triggermail.util.walk=function(a,b){b(a);for(a=a.firstChild;a;)walk(a,b),a=a.nextSibling};triggermail.util.walkUntil=function(a,b,c){ret=b(a);if(!0===c(ret))return ret;for(a=a.firstChild;a;)walk(a,b),a=a.nextSibling};triggermail.insanetiego=function(){return{inject_div:function(){$("body").append('<div id="insanetiego" style="position:fixed;bottom:0;width:100%;background:#D8E7ED;height:300px;overflow:scroll;z-index:2000;border-top-style:solid;border-top-width:5px;"></div>')},remove_div:function(){$("#insanetiego").remove()},
debug:function(){triggermail.util.cookie.set("tm_debug",!0);triggermail.integ.debug=!0;this.inject_div()},undebug:function(){triggermail.util.cookie.set("tm_debug",!1);triggermail.integ.debug=!1}}}();triggermail.core={};triggermail.core.sanitizer=function(){return{sanitize:function(a,b){if("email"==a){var c;c=/\S+@\S+\.\S+/.test(b)?b:null;return c}return b?b:""}}}();triggermail.integ=function(){return{init:function(){"undefined"!=typeof triggermail.Partner.init?triggermail.Partner.init():triggermail.integ.partnerInit();
try{triggermail.integ.checkLoop()}catch(a){}},partnerInit:function(a){var b=triggermail.Partner;if(!("undefined"==typeof a&&(jQuery(".translated-rtl, .translated-rtl").length||jQuery('meta[http-equiv="X-Translated-By"]').length))){try{b.trackProductView()}catch(c){triggermail.exception(c)}try{triggermail.Partner.trackAddToCart()}catch(e){triggermail.exception(e)}try{triggermail.Partner.trackCheckout()}catch(f){triggermail.exception(f)}try{triggermail.Partner.watchEmail()}catch(h){triggermail.exception(h)}if(triggermail.Partner.hasOwnProperty("trackRemoveFromCart"))try{triggermail.Partner.trackRemoveFromCart()}catch(p){triggermail.exception(p)}if(triggermail.Partner.hasOwnProperty("trackCheckoutStart"))try{triggermail.Partner.trackCheckoutStart()}catch(m){triggermail.exception(m)}if(triggermail.Partner.hasOwnProperty("trackUnsubscribe"))try{triggermail.Partner.trackUnsubscribe()}catch(u){triggermail.exception(u)}if(triggermail.Partner.hasOwnProperty("trackSubscribe"))try{triggermail.Partner.trackSubscribe()}catch(l){triggermail.exception(l)}if(triggermail.Partner.hasOwnProperty("trackSearch"))try{triggermail.Partner.trackSearch()}catch(n){triggermail.exception(n)}if(triggermail.Partner.hasOwnProperty("trackWishlist"))try{triggermail.Partner.trackWishlist()}catch(C){triggermail.exception(C)}if(triggermail.Partner.hasOwnProperty("trackContentView"))try{triggermail.Partner.trackContentView()}catch(w){triggermail.exception(w)}if(triggermail.Partner.hasOwnProperty("trackStop"))try{triggermail.Partner.trackStop()}catch(q){triggermail.exception(q)}}},
checkLoop:function(){var a=triggermail.util.getUrlParam("tme");if(0<a.length)triggermail.identify({email:a,source:"tme email append"},!0);else if(a=triggermail.util.getUrlParam("obem"),"undefined"!=typeof a&&""!=a&&triggermail.identify({obem:a,source:"obem email append"}),(a=decodeURIComponent(location.search).match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi)||decodeURIComponent(location.hash).match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi))&&triggermail.util.isValidEmail(a[0]))triggermail.identify({email:a[0],
source:"esp email append"});else{"undefined"!=typeof jQuery("#bluecore_purchase_pixel")&&0<jQuery("#bluecore_purchase_pixel").length&&(a=jQuery("#bluecore_purchase_pixel")[0].src,a=triggermail.util.getParamFromQueryString(a,"email"),triggermail.identify({email:a,source:"bluecore purchase pixel"}));try{var b=function(a){triggermail.util.wrapEvent(function(){triggermail.util.isValidEmail(a.email)&&triggermail.identify({email:a.email,source:"dom event"})})()},c=jQuery.fn.jquery.split(".");if(1<parseInt(c[0])||
1==parseInt(c[0])&&7<=parseInt(c[1]))jQuery(document).on("bc:identify",function(a,c){b(c)});else jQuery(document).bind("bc:identify",function(a,c){b(c)})}catch(e){}}}}}();triggermail.integ.ProductFetcher=__tmClass.extend({name:function(){return this._name},readOg:function(a){return jQuery('meta[property="'+a+'"]').attr("content")},category:function(){return this._category},color:function(){return this._color},size:function(){return this._size},price:function(){return this._price},brand:function(){return this._brand},
id:function(){return this._id},image:function(){return this._image},url:function(){return this._url},out_of_stock:function(){return!1},tags:function(){return this._tags},to_dict:function(){try{var a={name:triggermail.core.sanitizer.sanitize("name",this.name()),category:triggermail.core.sanitizer.sanitize("category",this.category()),size:triggermail.core.sanitizer.sanitize("size",this.size()),price:triggermail.core.sanitizer.sanitize("price",this.price()),brand:triggermail.core.sanitizer.sanitize("brand",
this.brand()),id:triggermail.core.sanitizer.sanitize("id",this.id()),image:triggermail.core.sanitizer.sanitize("image",this.image()),url:triggermail.core.sanitizer.sanitize("url",this.url()),out_of_stock:this.out_of_stock(),tags:this.tags(),color:triggermail.core.sanitizer.sanitize("color",this.color())},b;for(b in a)(""===a[b]||!1==a[b])&&"out_of_stock"!=b&&delete a[b];jQuery.extend(a,this.extra_props());return a}catch(c){triggermail.exception({location:"product_fetcher",error:c})}},extra_props:function(){return{}},
fetch:function(){return this.to_dict()}});triggermail.integ.ContentFetcher=__tmClass.extend({name:function(){return this._name},id:function(){return this._id},image:function(){return this._image},url:function(){return this._url},title:function(){return this._title},to_dict:function(){try{var a={id:triggermail.core.sanitizer.sanitize("id",this.id()),image:triggermail.core.sanitizer.sanitize("image",this.image()),name:triggermail.core.sanitizer.sanitize("name",this.name()),title:triggermail.core.sanitizer.sanitize("title",
this.title()),url:triggermail.core.sanitizer.sanitize("url",this.url())},b;for(b in a)(""===a[b]||!1==a[b])&&delete a[b];jQuery.extend(a,this.extra_props());return a}catch(c){triggermail.exception({location:"content_fetcher",error:c})}},extra_props:function(){return{}},fetch:function(){return this.to_dict()}});triggermail.integ.initServices=function(){triggermail.lytics.init(triggermail.integ.keys.lytics);triggermail.lytics=window["triggermail.lytics"];triggermail.lytics.set_config({save_referrer:!1,
store_google:!1,debug:triggermail.integ.debug})};triggermail.integ.loadJQuery=function(){var a=document.createElement("script");a.type="text/javascript";a.src=("https:"===document.location.protocol?"https://":"http://")+"ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)};(function(){function a(a,b){null==a[b]?null!=a[b+"_amount"]&&(a[b]=triggermail.util.price(a[b+"_amount"])):a[b]=triggermail.util.price(a[b]);
null==a[b+"_amount"]?null!=a[b]&&(a[b+"_amount"]=triggermail.util.price(a[b])):a[b+"_amount"]=triggermail.util.price(a[b+"_amount"]);null!=a[b]&&null==a[b+"_currency"]&&(a[b+"_currency"]="USD");return a}var b={},b=function(){for(var a=document.getElementsByTagName("META"),b={},c=0;c<a.length;c++){var e=a[c],u=e.getAttribute("property");if(u&&(u=u.match(/^product:(.*)$/i)))u=u[1],u=u.replace(":","_"),b[u]=e.getAttribute("content")}return b}(),c=function(b,c){var e=c||{},m;for(m in b){var u=e,l=m,n;
a:{n=b[m];for(var C=0;C<n.length;C++){var w;w=n[C][0];for(var q=n[C][1],z=document.getElementsByTagName("META"),B=[],y=0;y<z.length;y++){var d=z[y],t=d.getAttribute(w);t&&t.toLowerCase()==q.toLowerCase()&&B.push(d.getAttribute("content"))}w=B;if(0<w.length){n=w[0];break a}}n=null}u[l]=n}a(e,"price");a(e,"sale_price");a(e,"original_price");null!=e.availability&&(e.out_of_stock="oos"==e.availability||"pending"==e.availability?!0:!1);return e}({type:[["property","og:type"]],name:[["property","og:title"],
["property","product:title"]],url:[["property","og:url"],["property","product:url"],["property","product:product_link"]],image:[["property","og:image"],["property","product:image"]],id:[["property","product:id"],["property","product:sku"],["property","product:upc"],["property","product:isbn"],["property","product:ean"]],price:[["property","og:price"],["property","product:price"]],price_amount:[["property","og:price:amount"],["property","product:price:amount"]],price_currency:[["property","og:price:currency"],
["property","product:price:currency"]],description:[["property","og:description"],["name","description"]]}),e;for(e in c)b[e]=c[e];window.triggermail._meta_tags=window.triggermail._meta_tags||{};window.triggermail._meta_tags.page=b})();(function(){function a(){l===u&&(window.console&&window.console.debug)&&window.console.debug.apply(window.console,arguments)}function b(){l===u&&(window.console&&window.console.warn)&&window.console.warn.apply(window.console,arguments)}function c(){l===u&&(window.console&&
window.console.error)&&window.console.error.apply(window.console,arguments)}function e(a){var b=[];for(key in y[a])"_"!=key[0]&&b.push(key);return 0<b.length?a+" event can contain properties: "+b.join(", "):""}function f(a,b,c){var e=[],h;for(h in b){var l=b[h];if(l.constructor===Array)for(var m=0;m<l.length;m++)if(l[m].constructor===Array)for(var n=l[m][0],p=0;p<a[h].length;p++){var k=f(a[h][p],n,c+"."+h+"["+p+"]");void 0!==k.cleaned&&(a[h][p]=k.cleaned);for(var q=0;q<k.errors.length;q++)e.push(k.errors[q])}else try{k=
l[m](a[h]),void 0!==k&&(a[h]=k)}catch(u){e.push(c+"."+h+": "+u);break}else if(l.constructor===Function)try{l(a)}catch(w){e.push(w)}}return{cleaned:a,errors:e}}function h(d){for(var c,h,l,n=0;n<d.length;n++)try{var p=d[n],q=p[0],r=p[1];try{if(!q)throw"missing event";if(!r)throw"missing params";switch(q){case m.VIEW_PRODUCT:case m.ADD_TO_CART:case m.REMOVE_FROM_CART:r=r||window.bluecore.product;break;case m.PURCHASE:case m.VIEW_CATEGORY:case m.IDENTIFY:break;default:throw"unknown event <"+q+">";}var u=
f(r,y[q],q+" event -> payload");c=q;h=u.cleaned;l=u.errors}catch(k){if(q)throw"Error: "+String(q)+" -> "+k;throw"Error: "+k;}C.push({ev:c,params:h});if(0<l.length){b("Invalid event");for(var v=0;v<l.length;v++)b(l[v]);b(e(c))}}catch(w){C.push({ev:d[n][0],params:d[n][1]}),b("Invalid event"),b(w),b(e(d[n][0]))}d=C;C=[];for(c=0;c<d.length;c++)switch(h=d[c],a("Sending event: "+h.ev+", data: "+JSON.stringify(h.params)),h.ev){case m.VIEW_PRODUCT:triggermail.view(h.params);break;case m.ADD_TO_CART:triggermail.add_to_cart(h.params);
break;case m.REMOVE_FROM_CART:triggermail.remove_from_cart(h.params);break;case m.PURCHASE:triggermail.purchase(h.params);break;case m.VIEW_CATEGORY:l=h.params.category;'"'!=l[0]&&'"'!=l[l.length-1]&&(h.params.category='"'+l+'"');triggermail.search({search:h.params});break;case m.IDENTIFY:b("Note: re-identifies will be ignored."),triggermail.identify(h.params),null!=h.params.opt_in&&(h.params.opt_in?triggermail.optin(h.params):triggermail.unsubscribe(h.params))}}function p(){var b=Array.prototype.slice.call(window.bluecore||
[],0);window.bluecore={load:function(a){n=a},track:function(){h([Array.prototype.slice.call(arguments,0)])},product:window.triggermail._meta_tags.page||{},env:function(){return{namespace:n,env:l}},event_stream:window.triggermail.event_stream};window.debug_inject&&(a("DEBUG INJECT"),window.debug_inject());h(b);"product"==window.triggermail._meta_tags.page.type&&window.bluecore.track("view_product",window.bluecore.product)}var m={VIEW_PRODUCT:"view_product",ADD_TO_CART:"add_to_cart",REMOVE_FROM_CART:"remove_from_cart",
PURCHASE:"purchase",VIEW_CATEGORY:"view_category",SEARCH:"search",IDENTIFY:"identify"},u="dev",l,n,C=[],w=function(a,b){b=b||{};if(null!=a&&"instock"!=a){if("oos"==a||"pending"==a)return!1;if(!b.do_not_throw)throw'availability should be one of "instock", "oos", or "pending", but got "'+a+'"';}return!0},q={Required:function(a){return function(b){if(null==b)throw"missing "+(a||"required value");return b}},Email:function(a){return function(b){if(null!=b){b=b.trim().toLowerCase();if(!b.match(/.+@.+\..+/))throw a+
' is not valid: "'+b+'"';return b}}},Price:function(a){return function(a){if(null!=a&&(a=triggermail.util.price(a),isNaN(a)))throw"<"+a+"> is not valid price";return a}},NonEmptyString:function(a){return function(b){b=""+b;if(!b||!b.trim())throw a+" is empty";return b}},Availability:function(){return function(a){return w(a)}},OutOfStock:function(){return function(a){return!w(a,{do_not_throw:!0})}},NotEmptyArray:function(a){return function(b){if(null==b)throw"missing "+a;if(b.constructor!==Array)throw a+
" is not array";if(0>=b.length)throw a+" is empty";return b}},Bool:function(a){return function(b){var c;if(null!=b){if(b.constructor===Boolean)c=b;else if(b.constructor===String){var e=b.trim().toLowerCase();if("true"==e||"1"==e||"t"==e)c=!0;else if("false"==e||"0"==e||"f"==e)c=!1}else b.constructor===Number&&(1==b?c=!0:0==b&&(c=!1));if(!0!==c&&!1!==c)throw a+" should be a boolean, but got <"+b+"> of type <"+typeof b+">";}return c}}},z={id:[q.Required("product id"),q.NonEmptyString("product id")],
name:[q.Required("name"),q.NonEmptyString("name")],url:[q.Required("url"),q.NonEmptyString("url")],image:[q.Required("image"),q.NonEmptyString("image")],price:[q.Required("price"),q.Price("price")],price_currency:[],sale_price:[q.Price("sale_price")],sale_price_currency:[],original_price:[q.Price("original_price")],original_price_currency:[],category:[],brand:[],description:[],availability:[q.Availability()],out_of_stock:[q.OutOfStock()],__customValidation:function(a){if(a.sale_price&&null==a.original_price)throw'since you\'ve defined "sale_price", you must also define the "original_price"';
}},B={id:[q.Required("product id")]},y={};y[m.VIEW_PRODUCT]=z;y[m.ADD_TO_CART]=B;y[m.REMOVE_FROM_CART]=B;y[m.PURCHASE]={email:[q.Required("customer email"),q.Email("customer email")],total:[q.Required("total price of the purchase"),q.Price("total price of the purchase")],products:[q.NotEmptyArray("products array"),[B]],order_id:[]};y[m.VIEW_CATEGORY]={category:[q.Required("category"),q.NonEmptyString("category")]};y[m.IDENTIFY]={email:[q.Required("email"),q.Email("email")],name:[],source:[],opt_in:[q.Bool("opt_in")]};
(function(){function b(){0<_maxCheck&&(_maxCheck-=1,window.triggermail&&window.triggermail.__tm_initialized?p():setTimeout(b,100))}if(!window.bluecore)throw'object "window.bluecore" not found. Did you forget to include the snippet?';l=window.bluecore.env;n=window.bluecore.namespace;n.trim()?(window.triggermail=window.triggermail||{},window.triggermail.Partner={init:function(){},env:function(){return"prod"==l?"p":"d"},keys:{lytics:{d:n,p:n}}},_maxCheck=200,b()):c("Bluecore Integration is missing <namespace>")})()})();triggermail.initialize=
function(){triggermail.integ.keys={};var a=triggermail.Partner.env();triggermail.integ.keys.lytics=triggermail.Partner.keys.lytics[a];triggermail.integ.debug=!1;triggermail.integ.initServices();triggermail.init();a=triggermail.util.getUrlParam("__distinct_id_override__");""!=a&&(triggermail.lytics.cookie.props.distinct_id=a,triggermail.lytics.cookie.save());a=triggermail.util.getUrlParam("eton_distinct_id");""!=a&&(triggermail.lytics.cookie.props.distinct_id=a,triggermail.lytics.cookie.save());var a=
triggermail.util.getUrlParam("mc_eid"),b=triggermail.lytics.cookie.props.distinct_id;a&&b!==a&&(a="mceid_"+a,b!==a&&(triggermail.merge({merge:{source:b,destination:a},customer:{distinct_id:a}}),triggermail.lytics.cookie.props.distinct_id=a,triggermail.lytics.cookie.save(),triggermail.lytics.register({mc_eid:a})));triggermail.integ.init();a=triggermail.util.getUrlParam("__auto_demo__");""!=a&&(triggermail.demo(),triggermail.identify({email:a}));try{var c=JSON.parse(triggermail.util.cookie.get(triggermail.lytics.cookie.name));
(-1<window.location.pathname.indexOf("/eton/")||"undefined"==typeof c.email)&&triggermail.eton.init()}catch(e){}};var F=function(){triggermail.__tm_initialized||(window.jQuery?(triggermail.initialize(),triggermail.__tm_initialized=!0):window.setTimeout(F,100))};F()}else window.setTimeout(__xx_checkJquery,100)}__xx_checkJquery();
