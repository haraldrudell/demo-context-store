(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,n){e.exports=n(24)},20:function(e,t,n){},24:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),c=n(8),a=n.n(c),u=(n(20),n(3)),l=n.n(u),i=n(5),s=n(1),f=n(6),m=n(9),b=n(10),d=n(13),p=n(11),v=n(14),h=n(2),O=n(4),j={},g=function(){return E.forEach(function(e){return w(e,!0)})},E=[];function w(e,t){if("function"===typeof Object(e).next)return t?e.next(j):e;if("function"===typeof e)return t?e(j):e;throw new Error("plainStore: bad argument to subscribe")}var y=Object(r.createContext)(),S=y.Provider,C=(y.Consumer,{store:j,getState:function(){return j},subscribe:function(e){return E.push(w(e))&&{unsubscribe:function(){return function(e){var t=E.indexOf(e);t>=0&&E.splice(t,1)}(e)}}},notify:g});var x=Object(r.memo)(function(e){var t=e.children,n=e.store;return Object(r.useMemo)(function(){return function(e){e&&(Object.getOwnPropertyNames(j).forEach(function(e){return delete j[e]}),Object.assign(j,Object(O.a)({},e)))}(n)},[n])||o.a.createElement(S,{value:C},t)});var k=n(12);function P(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if("function"!==typeof e)throw new Error("useAllstore: selector not function");t=Object(O.a)({},t),n=!1!==n;var o=Object(r.useContext)(y);if(!o)throw new Error("useAllstore: store context missing, did Store component render?");var c=o.subscribe,a=o.store,u=Object(r.useRef)();console.log("CURRENT",typeof u.current,u.current);var l=Object(r.useRef)(),i=Object(r.useRef)();u.current=t;var f=Object(r.useState)(0),m=Object(s.a)(f,2),b=m[0],d=m[1];l.current=b;var p=Object(r.useMemo)(function(){return i.current=e(a,t)},n?[b].concat(Object(k.a)(Object.values(t))):void 0),v=Object(r.useMemo)(function(){return c(h)},[1]);function h(t){if(n){var r=i.current,o=Object.entries(e(t,u.current));if(Object.keys(r).length===o.length&&o.every(function(e){var t=Object(s.a)(e,2),n=t[0];return t[1]===r[n]}))return}d(l.current+1)}return Object(r.useEffect)(function(){return function(){return v.unsubscribe()}},[1]),p}var A,T,F=function(){return++j.value},N=function(e,t){var n=t.id;return{record:e.records.get(n)}};A=1,!isNaN(A=+A)&&(j.value=A),T=[{id:1,record:"One"},{id:2,record:"Two"}],j.records=Object(f.b)(T.map(function(e){return[e.id,Object(f.a)(e)]}));var R=Object(r.memo)(function(){var e=Object(r.useState)(2),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(r.useMemo)(function(){return I.bind(void 0,c,n)},[n]);return o.a.createElement(x,null,o.a.createElement("div",{style:{padding:"3em",display:"flex",height:"30em",flexDirection:"column",alignContent:"start"}},o.a.createElement("h1",null,"Demonstration of Allstore Single-Truth Store"),o.a.createElement("p",null,"94% less code-lines",o.a.createElement("br",null),"\u2003",o.a.createElement("a",{href:"https://www.npmjs.com/package/allstore"},"Allstore at npm"),o.a.createElement("br",null),"\u2003",o.a.createElement("a",{href:"https://github.com/haraldrudell/demo-context-store/tree/master/src/allstore"},"Allstore source code"),o.a.createElement("br",null)),o.a.createElement("p",null,"Click Increment to update value with 1 s delay via connect store-subscription",o.a.createElement("br",null),o.a.createElement("button",{onClick:M},"Increment")),"Click Change Id to display another record via:",o.a.createElement("ul",{style:{marginBlockStart:0,marginBlockEnd:0}},o.a.createElement("li",null,"useAllstore React 16.7 hook-subscription and"),o.a.createElement("li",null,"OrderedMap access")),o.a.createElement("div",{style:{marginBottom:"1em"}},o.a.createElement("button",{onClick:a},"Change Id")),o.a.createElement(J,null),o.a.createElement(H,{id:n}),o.a.createElement("p",null,"Written by Harald Rudell harald.rudell@gmail.com (http://www.haraldrudell.com)")))}),I=function(e,t,n){return e(3-t)},M=function(e){return function(){return B.apply(this,arguments)}().catch(console.error)};function B(){return(B=Object(i.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:F(),g();case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var U,D,_=function(){var e=Object(i.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,1e3)}));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),J=(U=function(e){return{value:e.value}},function(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;n||(n={});var c=String(n.displayName||t.displayName||t.name||"Connect"),a=!1!==n.pure;if("function"!==typeof e)throw new Error("connect: mapStateToProps not function");var u=function(n){function r(){var n,c;Object(m.a)(this,r);for(var a=arguments.length,u=new Array(a),l=0;l<a;l++)u[l]=arguments[l];return(c=Object(d.a)(this,(n=Object(p.a)(r)).call.apply(n,[this].concat(u)))).getSelectors=function(t){return Object(e(t,c.props))},c.getStoreProps=function(){return c.getSelectors(c.context.getState())},c.componentDidMount=function(){return(c.subscription=c.context.subscribe(Object(h.a)(Object(h.a)(c))))&&(c.lastProps=c.getStoreProps())},c.componentWillUnmount=function(){return c.subscription.unsubscribe()},c.render=function(){return o.a.createElement(t,Object.assign({},c.props,c.getStoreProps()))},c}return Object(v.a)(r,n),Object(b.a)(r,[{key:"next",value:function(e){if(a){var t=this.lastProps,n=this.getSelectors(e),r=Object.entries(n);if(Object.keys(t).length===r.length&&r.every(function(e){var n=Object(s.a)(e,2),r=n[0],o=n[1];return o===t[r]}))return;this.lastProps=n}this.setState({a:Object(this.state).a+1||1})}}]),r}(a?r.PureComponent:r.Component);return u.contextType=y,c&&(u.displayName=c),u}(U,e,D)})(Object(r.memo)(function(e){var t=e.value;return o.a.createElement("div",null,"value: ",String(t))})),H=Object(r.memo)(function(e){var t,n=e.id,r=((t=P(N,{id:n}).record)&&t.toJS()||{}).record;return o.a.createElement("div",null,"id: ",n," record: ",r||"")}),L=function(e){return{value:e.value}},W=function(){return j.value},K=function(){return console.log("inc")||++j.value&&g()},V=500,q=3;function z(){var e=Object(r.useState)(!0),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(r.useMemo)(function(){return setInterval(K,V)},[1]);console.log("FnContainer.render",n);var u=Object(r.useCallback)(function(){return console.log("FnContainer.hideFn")||clearInterval(a)||c(!1)},[1]);return o.a.createElement("div",null,"Check browser log for progress",n&&o.a.createElement(G,{hideFn:u}))}function G(e){var t=e.hideFn;console.log("Fn.render"),Object(r.useEffect)(function(){return W()>=q?console.log("Fn.hideFn")||t():void 0});var n=P(L).value;return console.log("Fn.render value:",n),n}a.a.render(Object({NODE_ENV:"production",PUBLIC_URL:"/demo-context-store"}).REACT_APP_TESTHOOK?o.a.createElement(function(){return console.log("UseAllstoreTest.render")||o.a.createElement(x,{store:{value:1}},o.a.createElement(z,null))},null):o.a.createElement(R,null),document.getElementById("root"))}},[[15,2,1]]]);
//# sourceMappingURL=main.f93997ad.chunk.js.map