<h1>Facebook JavaScript SDK</h1>
<div>The Facebook JavaScript SDK is described <a href="https://developers.facebook.com/docs/reference/javascript/">here</a>.
<ul>
<li>A minified version is available <a href="http://connect.facebook.net/en_US/all.js">here</a>.</li>
<li>A debug version is built <a href="/facebook/FacebookApi.debug.js">here</a>. Download the sdk from <a href="https://github.com/facebook/connect-js/">github</a> and build the file using the included file all.js.php</li>
<li>The channel file is html invoking the same api script. A coded version is available <a href="/facebook/channel.html">here</a>.</li>
<li>Is the cross-domain receiver required?</li>
</ul>
A JavaScript test console is provided <a href="https://developers.facebook.com/tools/console">here</a>.</div>
<h1>Configuring for the SDK</h1>
<div>
To use the sdk, you would need:
<ol>
<li>A Facebook app id</li>
<li>A page channel.html hosted on your site</li>
<li>On each page, an element with id fb-root</li>
<li>On each page, a script tag that loads the sdk</li>
</ol>
The required fb-root element is inserted after this paragraph.</div>
<div id="fb-root"></div>
<div>The element is above this paragraph. After the fb-root div, there is a script tag that defines the global function fbAsyncInit and appends a script tag to head.</div>
<h1>Local Development</h1>
<div>A facebook app can be run on the local machine if an app is created where the mobile web link is localhost, eg. http://localhost:3000</div>
<h1>Running the SDK</h1>
<div>This page loads a debug version of the sdk statically and is associated with a localhost-based facebook app. The sdk is not activated until the button below is clicked.<br/>
<p><button onclick="myLogin();">Login</button> status: <span id='status'>not clicked</span></p>
<ol>
<li>A user's login status is examined at <a href="http://www.facebook.com/extern/login_status.php">www.facebook.com</a></li>
<ul>
<li>If a cookie for this domain is present containing a valid session secret, the Facebook user has been identified</li>
<li>Otherwise, the fb-root element is styled to be a login dialog used to generate such cookie</li>
</ul>
<li>If the Facebook user has not awarded sufficient permissions to the Facebook app, the fb-root element is styled to be a permissions dialog used to request such permissions</li>
</ol></div>
<script src="//connect.facebook.net/en_US/all.js"></script>
<!--
<script src="/facebook/FacebookApi.debug.js"></script>
-->
<script>
function myLogin() {
	var element = document.getElementById('status')
	console.log(element)
	element.innerHTML = 'Initializing Facebook sdk...'
	FB.init({
		appId      : '179548482130062',
		channelURL : '<%= host %>/facebook/channel.html', // Channel File
		status     : true, // check login status
		cookie     : true, // enable cookies to allow the server to access the session
		//oauth      : true, // enable OAuth 2.0
		xfbml      : true  // parse XFBML
	})
	element.innerHTML = 'getting Facebook login status...'
	FB.getLoginStatus(function(response) {
		if (!response.authResponse) {
			// need to log the user in
			FB.login(function(response) {
				if (response.authResponse) {

					console.log('Welcome!  Fetching your information.... ');
					FB.api('/me', function(response) {
						var s = 'Good to see you, ' + response.name + '.'
						element.innerHTML = s
						console.log(s);
						FB.logout(function(response) {
							console.log('Logged out.');
						});
					});
				} else {
					var s = 'User cancelled login or did not fully authorize.'
					element.innerHTML = s
					console.log(s);
				}
			 }, {scope: 'email'});
		}
	});
}
</script>
